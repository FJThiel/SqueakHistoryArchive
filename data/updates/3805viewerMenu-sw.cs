'From Squeak3.1alpha of 28 February 2001 [latest update: #3811] on 8 March 2001 at 2:52:10 pm'!"Change Set:		viewerMenu-swDate:			8 March 2001Author:			Scott WallaceClears up an inconsistency involving what icon should be shown in the interior of a Viewer flap to offer a menu"!!Presenter methodsFor: 'viewer' stamp: 'sw 3/8/2001 14:51'!updateViewer: aViewer forceToShow: aCategory	"Update the given viewer to make sure it is in step with various possible changes in the outside world, and when reshowing it be sure it shows the given category"	| aPlayer aPosition newViewer oldOwner wasSticky barHeight cats |	cats _ aViewer categoriesCurrentlyShowing asOrderedCollection.	aCategory ifNotNil: [(cats includes: aCategory) ifFalse: [cats addFirst: aCategory]].	aPlayer _ aViewer scriptedPlayer.	aPosition _ aViewer position.	wasSticky _ aViewer isSticky.	newViewer _ aViewer species new visible: false.	barHeight _ aViewer submorphs first listDirection == #topToBottom		ifTrue:			[aViewer submorphs first submorphs first height]		ifFalse:			[0].	Preferences viewersInFlaps ifTrue:		[newViewer setProperty: #noInteriorThumbnail toValue: true].	newViewer initializeFor: aPlayer barHeight: barHeight includeDismissButton: aViewer hasDismissButton showCategories: cats.	wasSticky ifTrue: [newViewer beSticky].	oldOwner _ aViewer owner.	oldOwner ifNotNil:		[oldOwner replaceSubmorph: aViewer by: newViewer].		"It has happened that old readouts are still on steplist.  We may see again!!"	newViewer position: aPosition.	newViewer enforceTileColorPolicy.	newViewer visible: true.	newViewer world doIfNotNil: [:aWorld | aWorld startSteppingSubmorphsOf: newViewer].	newViewer layoutChanged! !