'From Squeak2.9alpha of 13 June 2000 [latest update: #3175] on 15 December 2000 at 12:23:27 am'!"Change Set:		InvalidationTweaks-arDate:			15 December 2000Author:			Andreas RaabA couple of tweaks for more efficient invalidations."!!Morph methodsFor: 'geometry' stamp: 'ar 12/14/2000 13:48'!bounds: newBounds	| oldExtent newExtent |	oldExtent _ self extent.	newExtent _ newBounds extent.	(oldExtent dotProduct: oldExtent) <= (newExtent dotProduct: newExtent) ifTrue:[		"We're growing. First move then resize."		self position: newBounds topLeft; extent: newExtent.	] ifFalse:[		"We're shrinking. First resize then move."		self extent: newExtent; position: newBounds topLeft.	].! !!Morph methodsFor: 'geometry' stamp: 'ar 12/14/2000 13:46'!position: aPoint	"Change the position of this morph and and all of its submorphs."	| delta box |	delta _ aPoint - bounds topLeft.	(delta x = 0 and: [delta y = 0]) ifTrue: [^ self].  "Null change"	box _ self fullBounds.	(delta dotProduct: delta) > 100 ifTrue:[		"e.g., more than 10 pixels moved"		self invalidRect: box.		self invalidRect: (box translateBy: delta).	] ifFalse:[		self invalidRect: (box merge: (box translateBy: delta)).	].	self privateFullMoveBy: delta.! !!Morph methodsFor: 'stepping and presenter' stamp: 'ar 12/15/2000 00:00'!stopStepping	"Stop getting sent the 'step' message."	| w |	w _ self world.	w ifNotNil: [w stopStepping: self].! !!Morph methodsFor: 'stepping and presenter' stamp: 'ar 12/15/2000 00:00'!stopSteppingSelector: aSelector	"Stop getting sent the given message."	| w |	w _ self world.	w ifNotNil: [w stopStepping: self selector: aSelector].! !!BalloonMorph methodsFor: 'initialization' stamp: 'ar 12/14/2000 23:59'!popUpForHand: aHand	"Pop up the receiver as balloon help for the given hand"	| worldBounds |	self lock.	self fullBounds. "force layout"	aHand world addMorphFront: self.	"So that if the translation below makes it overlap the receiver, it won't	interfere with the rootMorphsAt: logic and hence cause flashing.  Without	this, flashing happens, believe me!!"	((worldBounds _ aHand world bounds) containsRect: self bounds) ifFalse:		[self bounds: (self bounds translatedToBeWithin: worldBounds)].	aHand balloonHelp: self.! !