'From Squeak2.9alpha of 12 June 2000 [latest update: #2733] on 27 September 2000 at 8:27:30 am'!"Change Set:		NoChameleonsDate:			27 September 2000Author:			DanIngallsEnhances the direction handles so as to use colors that are not too similar to the underlying morph."!!Color methodsFor: 'equality' stamp: 'di 9/27/2000 08:07'!diff: theOther	"Returns a number between 0.0 and 1.0"	^ ((self privateRed - theOther privateRed) abs		+ (self privateGreen - theOther privateGreen) abs		+ (self privateBlue - theOther privateBlue) abs)		/ 3.0 / ComponentMax! !!Color methodsFor: 'transformations' stamp: 'di 9/27/2000 08:14'!orColorUnlike: theOther	"If this color is a lot like theOther, then return its complement, otherwide, return self"	(self diff: theOther) < 0.3		ifTrue: [^ theOther negated]		ifFalse: [^ self]! !!HaloMorph methodsFor: 'private' stamp: 'di 9/27/2000 08:12'!addDirectionHandles	| centerHandle d w directionShaft patch patchColor crossHairColor |	self showingDirectionHandles ifFalse: [^ self].	directionArrowAnchor _ target referencePositionInWorld rounded.	patch _ target imageFormForRectangle: (Rectangle center: directionArrowAnchor extent: 3@3).	patchColor _ patch colorAt: 1@1.	(directionShaft _ LineMorph newSticky makeForwardArrow)		borderWidth: 3; borderColor: (Color green orColorUnlike: patchColor).	self positionDirectionShaft: directionShaft.	self addMorphFront: directionShaft.	directionShaft setCenteredBalloonText: 'Set forward direction';		on: #mouseDown send: #doDirection:with: to: self;		on: #mouseStillDown send: #trackDirectionArrow:with: to: self;		on: #mouseUp send: #setDirection:with: to: self.	d _ 15.  "diameter"  w _ 3.  "borderWidth"	crossHairColor _ Color red orColorUnlike: patchColor.	(centerHandle _ EllipseMorph newBounds: (0@0 extent: d@d) color: Color transparent)			borderWidth: w; borderColor: (Color blue orColorUnlike: patchColor);			addMorph: (LineMorph from: (d//2)@w to: (d//2)@(d-w-1) color: crossHairColor width: 1);			addMorph: (LineMorph from: w@(d//2) to: (d-w-1)@(d//2) color: crossHairColor width: 1);			align: centerHandle bounds center with: directionArrowAnchor.	self addMorph: centerHandle.	centerHandle setCenteredBalloonText: 'Set rotation center';			on: #mouseDown send: #prepareToTrackCenterOfRotation:with: to: self;			on: #mouseStillDown send: #trackCenterOfRotation:with: to: self;			on: #mouseUp send: #setCenterOfRotation:with: to: self! !!HaloMorph methodsFor: 'private' stamp: 'di 9/27/2000 08:26'!doRecolor: evt with: aHandle	"Change the color of the target, if appropriate"	(aHandle containsPoint: evt cursorPoint)		ifFalse:  "only do it if mouse still in handle on mouse up"			[self delete.			target addHalo: evt]		ifTrue:			[innerTarget changeColor.			self showingDirectionHandles ifTrue: [self addHandles]]	! !