'From Squeak3.7alpha of 11 September 2003 [latest update: #5816] on 25 March 2004 at 4:09:37 pm'!"Change Set:		PSPointSizeFix-nkDate:			25 March 2004Author:			Ned KonzPostscript output from Squeak has been in pixel units. However, we're outputting requests for fonts in point units, making the fonts appear 3/4 as big as they should on output.This change set fixes that problem by also requesting fonts in pixel units."!!AbstractFont methodsFor: 'accessing' stamp: 'nk 3/25/2004 15:29'!pixelSize	"Make sure that we don't return a Fraction"	^ self pointSize * 96.0 / 72.0.! !!PostscriptCanvas methodsFor: 'private' stamp: 'nk 3/25/2004 15:36'!setFont:aFont	| fInfo |	aFont = currentFont ifTrue: [^self].	currentFont _ aFont.	self defineFont: aFont.	fInfo _ self class postscriptFontInfoForFont: aFont.	target 		selectflippedfont: fInfo first		size: (aFont pixelSize * fInfo second)		ascent: aFont ascent.! !!PostscriptCanvas class methodsFor: 'font mapping' stamp: 'nk 3/25/2004 16:06'!fontSampler	"Produces a Postscript .eps file on disk, returns a Morph."	"PostscriptCanvas fontSampler"	"PostscriptCanvas fontSampler openInWorld"	| morph file |	morph _ Morph new		layoutPolicy: TableLayout new;		listDirection: #topToBottom;		wrapDirection: #leftToRight;		hResizing: #shrinkWrap;		vResizing: #shrinkWrap;		color: Color white.	TextStyle actualTextStyles keysAndValuesDo: [ :styleName :style |		{ style fontArray first. style fontArray last } do: [ :baseFont | | info |			0 to: 2 do: [ :i | | font string string2 textMorph row |				font _ baseFont emphasized: i.				(i isZero or: [ font ~~ baseFont ]) ifTrue: [					string _ font fontNameWithPointSize.					row _ Morph new						layoutPolicy: TableLayout new;						listDirection: #topToBottom;						hResizing: #shrinkWrap;						vResizing: #shrinkWrap;						cellSpacing: 20@0;						color: Color white.							textMorph _ TextMorph new hResizing: #spaceFill; backgroundColor: Color white; beAllFont: font; contentsAsIs: string.					row addMorphBack: (textMorph imageForm asMorph).					info _ self postscriptFontInfoForFont: font.					string2 _ String streamContents: [ :stream |						stream nextPutAll: info first; space; print: (font pixelSize * info second) rounded.					].					textMorph _ TextMorph new hResizing: #spaceFill; backgroundColor: Color white; beAllFont: font; contentsAsIs: string2.					row addMorphBack: textMorph.										morph addMorphBack: row.				]			]		]	].	morph bounds: World bounds.	morph layoutChanged; fullBounds.	file _ (FileDirectory default newFileNamed: 'PSFontSampler.eps').	Cursor wait showWhile: [ 		file nextPutAll: (EPSCanvas morphAsPostscript: morph) ].	^morph! !!PostscriptCanvas class methodsFor: 'font mapping' stamp: 'nk 3/25/2004 15:55'!postscriptFontMappingSummary	"	Transcript nextPutAll: 	PostscriptCanvas postscriptFontMappingSummary	; endEntry	"	| stream |	stream _ WriteStream on: (String new: 1000).	TextStyle actualTextStyles keysAndValuesDo: [ :styleName :style |		stream nextPutAll: styleName; cr.		style fontArray do: [ :baseFont | | info |			0 to: 3 do: [ :i | | font |				font _ baseFont emphasized: i.				font emphasis = i ifTrue: [					stream tab; nextPutAll: font fontNameWithPointSize; tab.					info _ self postscriptFontInfoForFont: font.					stream nextPutAll: info first; space; print: (font pixelSize * info second) rounded.					stream cr.				]			]		]	].	^stream contents! !