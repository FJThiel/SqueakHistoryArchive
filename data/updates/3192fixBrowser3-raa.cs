'From Squeak2.9alpha of 17 July 2000 [latest update: #3249] on 10 January 2001 at 7:21:57 pm'!"Change Set:		fixBrowser3Date:			10 January 2001Author:			Bob ArningFurther improvements to browsers wrt fixed height panes."!!Browser methodsFor: 'initialize-release' stamp: 'RAA 1/10/2001 11:45'!addAListPane: aListPane to: window at: nominalFractions plus: verticalOffset	| row switchHeight |	row _ AlignmentMorph newColumn		hResizing: #spaceFill;		vResizing: #spaceFill;		layoutInset: 0;		borderWidth: 0;		layoutPolicy: ProportionalLayout new.	switchHeight _ 25.	row 		addMorph: aListPane		fullFrame: (			LayoutFrame 				fractions: (0@0 corner: 1@1) 				offsets: (0@0 corner: 0@switchHeight negated)		).			self 		addMorphicSwitchesTo: row 		at: (			LayoutFrame 				fractions: (0@1 corner: 1@1) 				offsets: (0@switchHeight negated  corner: 0@0)		).	window 		addMorph: row		fullFrame: (			LayoutFrame 				fractions: nominalFractions 				offsets: (0@verticalOffset corner: 0@0)		).		row borderWidth: 0.	row on: #mouseEnter send: #paneTransition: to: window.	row on: #mouseLeave send: #paneTransition: to: window.! !!Browser methodsFor: 'initialize-release' stamp: 'RAA 1/10/2001 11:46'!addClassAndSwitchesTo: window at: nominalFractions plus: verticalOffset	^self		addAListPane: self buildMorphicClassList 		to: window 		at: nominalFractions 		plus: verticalOffset! !!Browser methodsFor: 'initialize-release' stamp: 'RAA 1/10/2001 11:53'!addLowerPanesTo: window at: nominalFractions with: editString	| verticalOffset row innerFractions |	row _ AlignmentMorph newColumn		hResizing: #spaceFill;		vResizing: #spaceFill;		layoutInset: 0;		borderWidth: 1;		borderColor: Color black;		layoutPolicy: ProportionalLayout new.	verticalOffset _ 0.	innerFractions _ 0@0 corner: 1@0.	verticalOffset _ self addOptionalAnnotationsTo: row at: innerFractions plus: verticalOffset.	verticalOffset _ self addOptionalButtonsTo: row  at: innerFractions plus: verticalOffset.	row 		addMorph: ((self buildMorphicCodePaneWith: editString) borderWidth: 0)		fullFrame: (			LayoutFrame 				fractions: (innerFractions withBottom: 1) 				offsets: (0@verticalOffset corner: 0@0)		).	window 		addMorph: row		frame: nominalFractions.	"row borderWidth: 0."	row on: #mouseEnter send: #paneTransition: to: window.	row on: #mouseLeave send: #paneTransition: to: window.! !!Browser methodsFor: 'initialize-release' stamp: 'RAA 1/10/2001 12:00'!addOptionalAnnotationsTo: window at: fractions plus: verticalOffset	| aTextMorph delta |	Preferences useAnnotationPanes ifFalse: [^verticalOffset].	aTextMorph _ PluggableTextMorph 		on: self		text: #annotation 		accept: nil		readSelection: nil		menu: nil.	aTextMorph		askBeforeDiscardingEdits: false;		borderWidth: 1;		borderColor: Color lightGray.	delta _ 25.	window 		addMorph: aTextMorph 		fullFrame: (			LayoutFrame 				fractions: fractions 				offsets: (0@verticalOffset corner: 0@(verticalOffset + delta))		).	^verticalOffset + delta! !!Browser methodsFor: 'initialize-release' stamp: 'RAA 1/10/2001 12:01'!addOptionalButtonsTo: window at: fractions plus: verticalOffset	| delta buttons |	Preferences optionalButtons ifFalse: [^verticalOffset].	delta _ 25.	buttons _ self optionalButtonRow 		color: (Color gray alpha: 0.2);		borderWidth: 1;		borderColor: Color lightGray.	window 		addMorph: buttons		fullFrame: (			LayoutFrame 				fractions: fractions 				offsets: (0@verticalOffset corner: 0@(verticalOffset + delta))		).	^verticalOffset + delta! !!Browser methodsFor: 'initialize-release' stamp: 'RAA 1/10/2001 11:02'!openAsMorphClassEditing: editString	"Create a pluggable version a Browser on just a single class."	| window dragNDropFlag hSepFrac switchHeight mySingletonClassList |	window _ (SystemWindow labelled: 'later') model: self.	dragNDropFlag _ Preferences browseWithDragNDrop.	hSepFrac _ 0.3.	switchHeight _ 25.	mySingletonClassList _ PluggableListMorph on: self list: #classListSingleton			selected: #indexIsOne changeSelected: #indexIsOne:			menu: #classListMenu:shifted: keystroke: #classListKey:from:.	mySingletonClassList enableDragNDrop: dragNDropFlag.	window 		addMorph: mySingletonClassList		fullFrame: (			LayoutFrame 				fractions: (0@0 corner: 0.5@0) 				offsets: (0@0 corner: 0@switchHeight)		).		self 		addMorphicSwitchesTo: window 		at: (			LayoutFrame 				fractions: (0.5@0 corner: 1.0@0) 				offsets: (0@0 corner: 0@switchHeight)		).	window 		addMorph: self buildMorphicMessageCatList		fullFrame: (			LayoutFrame 				fractions: (0@0 corner: 0.5@hSepFrac) 				offsets: (0@switchHeight corner: 0@0)		).	window 		addMorph: self buildMorphicMessageList		fullFrame: (			LayoutFrame 				fractions: (0.5@0 corner: 1.0@hSepFrac) 				offsets: (0@switchHeight corner: 0@0)		).	self 		addLowerPanesTo: window 		at: (0@hSepFrac corner: 1@1) 		with: editString.	window setUpdatablePanesFrom: #(messageCategoryList messageList).	^ window! !!Browser methodsFor: 'initialize-release' stamp: 'RAA 1/10/2001 11:30'!openAsMorphEditing: editString	"Create a pluggable version of all the morphs for a Browser in Morphic"	| window dragNDropFlag myCatList hSepFrac |	hSepFrac _ 0.4.	window _ (SystemWindow labelled: 'later') model: self.	dragNDropFlag _ Preferences browseWithDragNDrop.	myCatList _ PluggableListMorph on: self list: #systemCategoryList			selected: #systemCategoryListIndex changeSelected: #systemCategoryListIndex:			menu: #systemCategoryMenu: keystroke: #systemCatListKey:from:.	myCatList enableDragNDrop: dragNDropFlag.	window 		addMorph: myCatList		frame: (0@0 corner: 0.25@hSepFrac).	self 		addClassAndSwitchesTo: window 		at: (0.25@0 corner: 0.5@hSepFrac)		plus: 0.	window 		addMorph: self buildMorphicMessageCatList		frame: (0.5@0 extent: 0.25@hSepFrac).	window addMorph: self buildMorphicMessageList		frame: (0.75@0 extent: 0.25@hSepFrac).	self 		addLowerPanesTo: window 		at: (0@hSepFrac corner: 1@1) 		with: editString.	window setUpdatablePanesFrom: #(systemCategoryList classList messageCategoryList messageList).	^ window! !!Browser methodsFor: 'initialize-release' stamp: 'RAA 1/10/2001 10:59'!openAsMorphMsgCatEditing: editString	"Create a pluggable version a Browser on just a message category."	| window hSepFrac |	window _ (SystemWindow labelled: 'later') model: self.	hSepFrac _ 0.3.	window 		addMorph: ((PluggableListMorph on: self list: #messageCatListSingleton			selected: #indexIsOne changeSelected: #indexIsOne:			menu: #messageCategoryMenu:) enableDragNDrop: Preferences browseWithDragNDrop)		fullFrame: (			LayoutFrame 				fractions: (0@0 corner: 1@0) 				offsets: (0@0 corner: 0@25)		).	window 		addMorph: self buildMorphicMessageList		fullFrame: (			LayoutFrame 				fractions: (0@0 corner: 1@hSepFrac) 				offsets: (0@25 corner: 0@0)		).	self 		addLowerPanesTo: window 		at: (0@hSepFrac corner: 1@1) 		with: editString.	window setUpdatablePanesFrom: #(messageCatListSingleton messageList).	^ window! !!Browser methodsFor: 'initialize-release' stamp: 'RAA 1/10/2001 11:31'!openAsMorphSysCatEditing: editString	"Create a pluggable version of all the views for a Browser, including views and controllers."	| window hSepFrac switchHeight mySingletonList nextOffsets |	window _ (SystemWindow labelled: 'later') model: self.	hSepFrac _ 0.30.	switchHeight _ 25.	mySingletonList _ PluggableListMorph on: self list: #systemCategorySingleton			selected: #indexIsOne changeSelected: #indexIsOne:			menu: #systemCatSingletonMenu: keystroke: #systemCatSingletonKey:from:. 	mySingletonList enableDragNDrop: Preferences browseWithDragNDrop.	window 		addMorph: mySingletonList		fullFrame: (			LayoutFrame 				fractions: (0@0 corner: 1@0) 				offsets: (0@0  corner: 0@switchHeight)		).		self 		addClassAndSwitchesTo: window 		at: (0@0 corner: 0.3333@hSepFrac)		plus: switchHeight.	nextOffsets _ 0@switchHeight corner: 0@0.	window 		addMorph: self buildMorphicMessageCatList		fullFrame: (			LayoutFrame 				fractions: (0.3333@0 corner: 0.6666@hSepFrac) 				offsets: nextOffsets		).		window 		addMorph: self buildMorphicMessageList		fullFrame: (			LayoutFrame 				fractions: (0.6666@0 corner: 1@hSepFrac) 				offsets: nextOffsets		).		self 		addLowerPanesTo: window 		at: (0@hSepFrac corner: 1@1) 		with: editString.	window setUpdatablePanesFrom: #( classList messageCategoryList messageList).	^ window! !!MessageSet methodsFor: 'private' stamp: 'RAA 1/10/2001 11:14'!openAsMorphNamed: labelString inWorld: aWorld	| window listFraction |	window _ (SystemWindow labelled: labelString) model: self.	listFraction _ 0.2.	window addMorph: self buildMorphicMessageList frame: (0@0 extent: 1@listFraction).	self 		addLowerPanesTo: window 		at: (0@listFraction corner: 1@1) 		with: nil.	window setUpdatablePanesFrom: #(messageList).	window openInWorld: aWorld! !!MessageSet class methodsFor: 'instance creation' stamp: 'RAA 1/10/2001 11:07'!openAsMorph: aMessageSet name: labelString inWorld: aWorld	^aMessageSet openAsMorphNamed: labelString inWorld: aWorld! !!SystemWindow methodsFor: 'panes' stamp: 'RAA 1/10/2001 19:01'!setUpdatablePanesFrom: getSelectors	| aList aPane possibles |	"Set my updatablePanes inst var to the list of panes which are list panes with the given get-list selectors.  Order is important here!!  Note that the method is robust in the face of panes not found, but a warning is printed in the transcript in each such case"	aList _ OrderedCollection new.	possibles _ OrderedCollection new.	self allMorphsDo: [ :pane | 		(pane isKindOf: PluggableListMorph) ifTrue: [			possibles add: pane.		].	].	getSelectors do: [:sel | 		aPane _ possibles detect: [ :pane | pane getListSelector == sel] ifNone: [nil].		aPane			ifNotNil:				[aList add: aPane]			ifNil:				[Transcript cr; show: 'Warning: pane ', sel, ' not found.']].	updatablePanes _ aList asArray! !Browser removeSelector: #addClassAndSwitchesTo:at:!