'From Squeak3.2alpha of 2 October 2001 [latest update: #4430] on 14 October 2001 at 9:52:11 pm'!"Change Set:		limitClass-swDate:			14 October 2001Author:			Scott WallaceMakes a smarter initial choice of limit-class for a Lexicon or InstanceBrowser -- chooses the supermost class just *before* reaching Object (or Object class, if a metaclass)."!!Lexicon methodsFor: 'initialization' stamp: 'sw 10/12/2001 21:36'!openOnClass: aTargetClass inWorld: aWorld showingSelector: aSelector	"Create and open a SystemWindow to house the receiver, showing the categories pane.  The target-object parameter is optional -- if nil, the browser will be associated with the class as a whole but not with any particular instance of it."	| window aListMorph catListFraction |	currentVocabulary ifNil: [currentVocabulary _ Vocabulary fullVocabulary].	targetClass _ aTargetClass.	self initialLimitClass.		window _ self windowWithLabel: self startingWindowTitle.	catListFraction _ 0.20.		window addMorph: self newCategoryPane frame: (0 @ 0 corner: 0.5 @ catListFraction).	aListMorph _ PluggableListMorph new.	aListMorph 	setProperty: #balloonTextSelectorForSubMorphs toValue: #balloonTextForLexiconString.	aListMorph on: self list: #messageList			selected: #messageListIndex changeSelected: #messageListIndex:			menu: #messageListMenu:shifted:			keystroke: #messageListKey:from:.	aListMorph setNameTo: 'messageList'.	aListMorph menuTitleSelector: #messageListSelectorTitle.	window addMorph: aListMorph frame: (0.5 @ 0 corner: 1 @ catListFraction).		"side by side"	self 		addLowerPanesTo: window 		at: (0 @ catListFraction  corner: 1@1) 		with: nil.	window changeAllBorderColorsFrom: Color black to: (self defaultBackgroundColor mixed: 0.5 with: Color black).	window color: self defaultBackgroundColor.	window openInWorld: aWorld.	self reformulateCategoryList.	aSelector ifNotNil: [self selectSelectorItsNaturalCategory: aSelector] ifNil: [self categoryListIndex: 1].	#(navigateToPreviousMethod	 navigateToNextMethod removeFromSelectorsVisited) do:		[:sel |			(self buttonWithSelector: sel) ifNotNilDo:				[:aButton | aButton borderWidth: 0]].	self adjustWindowTitle! !!Lexicon methodsFor: 'limit class' stamp: 'sw 10/12/2001 21:47'!initialLimitClass	"Choose a plausible initial vlaue for the limit class, and answer it"	| oneTooFar |	(#('ProtoObject' 'Object' 'Behavior' 'ClassDescription' 'Class' 'ProtoObject class' 'Object class') includes: targetClass name asString) ifTrue: [^ targetClass].	oneTooFar _ (targetClass isKindOf: Metaclass)		ifTrue:			[Object class]		ifFalse:			[Object].	limitClass _ targetClass.	[limitClass superclass ~~ oneTooFar]		whileTrue: [limitClass _ limitClass superclass].	^ limitClass! !!Lexicon methodsFor: 'limit class' stamp: 'sw 10/12/2001 21:30'!limitClass	"Answer the most generic class to show in the browser.  By default, we go all the way up to ProtoObject"	^ limitClass ifNil: [self initialLimitClass]! !