'From Squeakland.396-Nihongo7.29 of 14 March 2005 [latest update: #54] on 16 March 2005 at 3:44:41 pm'!"Change Set:		robustWorldDate:			16 March 2005Author:			Yoshiki OhshimaSome fixes to prevent move the world around.  Eventually we would like to look at all reference to costume and senders of costume, but so far..."!!Player methodsFor: 'scripts-standard' stamp: 'yo 3/16/2005 15:43'!goToRightOf: aPlayer 	"Place the object so that it lies directly to the right of the given object"	| hisCostume aCostume |	(aPlayer isNil or: [aPlayer == self]) ifTrue: [^self].	(hisCostume := aPlayer costume) isInWorld ifFalse: [^self].	aCostume := self costume.	aCostume isWorldMorph ifTrue: [^ self].	aCostume owner == hisCostume owner 		ifFalse: [hisCostume owner addMorphFront: aCostume].	aCostume 		position: hisCostume bounds rightCenter - (0 @ (aCostume height // 2))! !!Player methodsFor: 'scripts-standard' stamp: 'yo 3/16/2005 15:44'!turnToward: aPlayer	"Turn to the direction of the given player."	| angle aCostume |	(aPlayer == nil or: [aPlayer == self]) ifTrue: [^ self].	aCostume _ self costume.	aCostume isWorldMorph ifTrue: [^ self].	(aCostume bounds intersects: aPlayer costume bounds) ifTrue: [^ self].	angle _ aCostume referencePosition bearingToPoint: aPlayer costume referencePosition.	self setHeading: angle.! !!Player methodsFor: 'slot getters/setters' stamp: 'yo 3/16/2005 15:32'!setBottom: w	"Set the bottom coordinate (cartesian sense) of the object as requested"	| topLeftNow cost |	cost _ self costume.	cost isWorldMorph ifTrue: [^ self].	topLeftNow _ cost cartesianBoundsTopLeft.	^ cost bottom: cost top + topLeftNow y - w! !!Player methodsFor: 'slot getters/setters' stamp: 'yo 3/16/2005 15:35'!setDistance: aDistance	"Set the object's distance from the origin to be as indicated, preserving its angle."	| cost |	cost _ self costume.	cost isWorldMorph ifTrue: [^ self].	cost cartesianXY: (Point r: aDistance degrees:  self getTheta)! !!Player methodsFor: 'slot getters/setters' stamp: 'yo 3/16/2005 15:34'!setHeading: newHeading	"Set the heading as indicated"	| aCostume |	aCostume _ self costume.	aCostume isWorldMorph ifTrue: [^ self].	(newHeading closeTo: aCostume heading) ifTrue: [^ self].	aCostume heading: newHeading.	aCostume _ self costume. "in case we just got flexed for no apparent reason"	(aCostume isFlexMorph and:[aCostume hasNoScaleOrRotation]) 		ifTrue:	[aCostume removeFlexShell]! !!Player methodsFor: 'slot getters/setters' stamp: 'yo 3/16/2005 15:32'!setLeft: w	"Set the object's left coordinate as indicated"	| topLeftNow cost |	cost _ self costume.	cost isWorldMorph ifTrue: [^ self].	topLeftNow _ cost cartesianBoundsTopLeft.	^ cost left: cost left - topLeftNow x + w! !!Player methodsFor: 'slot getters/setters' stamp: 'yo 3/16/2005 15:32'!setRight: w	"Set the right coordinate to the given value"	| topLeftNow cost |	cost _ self costume.	cost isWorldMorph ifTrue: [^ self].	topLeftNow _ cost cartesianBoundsTopLeft.	^ cost right: cost left - topLeftNow x + w! !!Player methodsFor: 'slot getters/setters' stamp: 'yo 3/16/2005 15:33'!setScaleFactor: aNumber	"Set the scale factor to be the given value"	| cost |	cost _ self costume.	cost isWorldMorph ifTrue: [^ self].	cost scaleFactor: ((aNumber asFloat max: 0.1) min: 10.0)! !!Player methodsFor: 'slot getters/setters' stamp: 'yo 3/16/2005 15:35'!setTheta: aTheta	"Set the object's position such that its rho is unchanged but the angle between the positive x-axis and the vector connecting the origin and the object's position is as given."	| cost |	cost _ self costume.	cost isWorldMorph ifTrue: [^ self].	cost cartesianXY: (Point r: self getDistance degrees: aTheta)! !!Player methodsFor: 'slot getters/setters' stamp: 'yo 3/16/2005 15:32'!setTop: w	"Set the top coordinate as indicated, using cartesian sense"	| topLeftNow cost |	cost _ self costume.	cost isWorldMorph ifTrue: [^ self].	topLeftNow _ cost cartesianBoundsTopLeft.	^ cost top: cost top + topLeftNow y - w! !!Player methodsFor: 'slot getters/setters' stamp: 'yo 3/16/2005 15:30'!setWidth: aWidth	"Set the width"	| cost widthToUse |	cost _ self costume.	cost isWorldMorph ifTrue: [^ self].	cost isLineMorph		ifTrue:			[^ cost unrotatedWidth: aWidth].	widthToUse _ cost isRenderer		ifTrue:			[aWidth / cost scaleFactor]		ifFalse:			[aWidth].	cost renderedMorph width: widthToUse! !