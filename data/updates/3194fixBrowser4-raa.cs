'From Squeak2.9alpha of 17 July 2000 [latest update: #3253] on 11 January 2001 at 9:01:02 am'!"Change Set:		fixBrowser4Date:			11 January 2001Author:			Bob ArningMore fixed pane changes to some of the other browser-like things. Also, dropped translucent gray when in 8-bit depth or less."!!CodeHolder methodsFor: 'misc' stamp: 'RAA 1/11/2001 08:40'!addLowerPanesTo: window at: nominalFractions with: editString	| verticalOffset row innerFractions |	row _ AlignmentMorph newColumn		hResizing: #spaceFill;		vResizing: #spaceFill;		layoutInset: 0;		borderWidth: 1;		borderColor: Color black;		layoutPolicy: ProportionalLayout new.	verticalOffset _ 0.	innerFractions _ 0@0 corner: 1@0.	verticalOffset _ self addOptionalAnnotationsTo: row at: innerFractions plus: verticalOffset.	verticalOffset _ self addOptionalButtonsTo: row  at: innerFractions plus: verticalOffset.	row 		addMorph: ((self buildMorphicCodePaneWith: editString) borderWidth: 0)		fullFrame: (			LayoutFrame 				fractions: (innerFractions withBottom: 1) 				offsets: (0@verticalOffset corner: 0@0)		).	window 		addMorph: row		frame: nominalFractions.	"row borderWidth: 0."	row on: #mouseEnter send: #paneTransition: to: window.	row on: #mouseLeave send: #paneTransition: to: window.! !!CodeHolder methodsFor: 'misc' stamp: 'RAA 1/11/2001 08:22'!addOptionalAnnotationsTo: window at: fractions plus: verticalOffset	| aTextMorph delta |	Preferences useAnnotationPanes ifFalse: [^verticalOffset].	aTextMorph _ PluggableTextMorph 		on: self		text: #annotation 		accept: nil		readSelection: nil		menu: nil.	aTextMorph		askBeforeDiscardingEdits: false;		borderWidth: 1;		borderColor: Color lightGray.	delta _ 25.	window 		addMorph: aTextMorph 		fullFrame: (			LayoutFrame 				fractions: fractions 				offsets: (0@verticalOffset corner: 0@(verticalOffset + delta))		).	^verticalOffset + delta! !!CodeHolder methodsFor: 'misc' stamp: 'RAA 1/11/2001 08:22'!addOptionalButtonsTo: window at: fractions plus: verticalOffset	| delta buttons |	Preferences optionalButtons ifFalse: [^verticalOffset].	delta _ 25.	buttons _ self optionalButtonRow 		color: (Display depth <= 8 ifTrue: [Color transparent] ifFalse: [Color gray alpha: 0.2]);		borderWidth: 1;		borderColor: Color lightGray.	window 		addMorph: buttons		fullFrame: (			LayoutFrame 				fractions: fractions 				offsets: (0@verticalOffset corner: 0@(verticalOffset + delta))		).	^verticalOffset + delta! !!CodeHolder methodsFor: 'misc' stamp: 'RAA 1/11/2001 08:54'!buildMorphicCodePaneWith: editString	| codePane |	codePane _ PluggableTextMorph 		on: self 		text: #contents 		accept: #contents:notifying:		readSelection: #contentsSelection 		menu: #codePaneMenu:shifted:.	editString ifNotNil: [		codePane editString: editString.		codePane hasUnacceptedEdits: true	].	^codePane! !!ChangeList methodsFor: 'initialization-release' stamp: 'RAA 1/11/2001 08:44'!openAsMorphName: labelString multiSelect: multiSelect	"Open a morphic view for the messageSet, whose label is labelString.	The listView may be either single or multiple selection type"	| window listHeight |	listHeight _ 0.4.	window _ (SystemWindow labelled: labelString)		model: self.	window addMorph: ((multiSelect				ifTrue: [PluggableListMorphOfMany]				ifFalse: [PluggableListMorph])			on: self			list: #list			selected: #listIndex			changeSelected: #toggleListIndex:			menu: (self showsVersions				ifTrue: [#versionsMenu:]				ifFalse: [#changeListMenu:]))		frame: (0 @ 0 extent: 1 @ listHeight).	self 		addLowerPanesTo: window 		at: (0@listHeight corner: 1@1) 		with: nil.	^ window openInWorld! !!ChangeList methodsFor: 'menu actions' stamp: 'RAA 1/11/2001 08:42'!buildMorphicCodePaneWith: editString	| codePane |	codePane _ AcceptableCleanTextMorph		on: self		text: #contents 		accept: #contents:		readSelection: #contentsSelection 		menu: #codePaneMenu:shifted:.	editString ifNotNil: [		codePane editString: editString.		codePane hasUnacceptedEdits: true	].	^codePane! !!ChangeList methodsFor: 'menu actions' stamp: 'RAA 1/11/2001 08:35'!optionalButtonRow	| aRow aButton |	aRow _ AlignmentMorph newRow.	aRow hResizing: #spaceFill.	aRow clipSubmorphs: true.	aRow addTransparentSpacerOfSize: (5@0).	aRow wrapCentering: #center; cellPositioning: #leftCenter.	self changeListButtonSpecs do:		[:triplet |			aButton _ PluggableButtonMorph				on: self				getState: nil				action: triplet second.			aButton useRoundedCorners;				label: triplet first asString;				askBeforeChanging: true;				onColor: Color transparent offColor: Color transparent.			aRow addMorphBack: aButton.			aRow addTransparentSpacerOfSize: (3 @ 0).			aButton setBalloonText: triplet third.			aRow addMorphBack: aButton.			aRow addTransparentSpacerOfSize: (3 @ 0).			aButton setBalloonText: triplet third.			aRow addTransparentSpacerOfSize: (3 @ 0)].	aRow addMorphBack: self diffButton.		^ aRow! !!ChangeList class methodsFor: 'instance creation' stamp: 'RAA 1/11/2001 08:20'!openAsMorph: aChangeList name: labelString multiSelect: multiSelect	"Open a morphic view for the messageSet, whose label is labelString.	The listView may be either single or multiple selection type"	^aChangeList openAsMorphName: labelString multiSelect: multiSelect! !!Debugger methodsFor: 'initialize' stamp: 'RAA 1/11/2001 08:55'!openFullMorphicLabel: labelString	| window aListMorph |	self expandStack.	window _ (SystemWindow labelled: labelString) model: self.	aListMorph _ PluggableListMorph on: self list: #contextStackList			selected: #contextStackIndex changeSelected: #toggleContextStackIndex:			menu: #contextStackMenu:shifted: keystroke: #contextStackKey:from:.	aListMorph menuTitleSelector: #messageListSelectorTitle.	window addMorph: aListMorph		frame: (0@0 corner: 1@0.3).	self addLowerPanesTo: window at: (0@0.3 corner: 1@0.7) with: nil.	window addMorph: (		PluggableListMorph new			doubleClickSelector: #inspectSelection;			on: self receiverInspector list: #fieldList			selected: #selectionIndex changeSelected: #toggleIndex:			menu: #fieldListMenu: keystroke: #inspectorKey:from:)		frame: (0@0.7 corner: 0.2@1).	window addMorph: (PluggableTextMorph on: self receiverInspector			text: #contents accept: #accept:			readSelection: #contentsSelection menu: #codePaneMenu:shifted:)		frame: (0.2@0.7 corner: 0.5@1).	window addMorph: (		PluggableListMorph new			doubleClickSelector: #inspectSelection;			on: self contextVariablesInspector list: #fieldList			selected: #selectionIndex changeSelected: #toggleIndex:			menu: #fieldListMenu: keystroke: #inspectorKey:from:)		frame: (0.5@0.7 corner: 0.7@1).	window addMorph: (PluggableTextMorph on: self contextVariablesInspector			text: #contents accept: #accept:			readSelection: #contentsSelection menu: #codePaneMenu:shifted:)		frame: (0.7@0.7 corner: 1@1).	^ window openInWorld! !!FileContentsBrowser methodsFor: 'creation' stamp: 'RAA 1/11/2001 07:31'!addLowerPanesTo: window at: nominalFractions with: editString	| verticalOffset row innerFractions codePane infoPane infoHeight |	row _ AlignmentMorph newColumn		hResizing: #spaceFill;		vResizing: #spaceFill;		layoutInset: 0;		borderWidth: 1;		borderColor: Color black;		layoutPolicy: ProportionalLayout new.	codePane _ PluggableTextMorph on: self text: #contents accept: #contents:notifying:			readSelection: #contentsSelection menu: #codePaneMenu:shifted:.	infoPane _ PluggableTextMorph on: self text: #infoViewContents accept: nil			readSelection: nil menu: nil.	verticalOffset _ 0.	innerFractions _ 0@0 corner: 1@0.">>not with this browser--- at least not yet ---	verticalOffset _ self addOptionalAnnotationsTo: row at: innerFractions plus: verticalOffset.	verticalOffset _ self addOptionalButtonsTo: row  at: innerFractions plus: verticalOffset.<<<<"	infoHeight _ 20.	row 		addMorph: (codePane borderWidth: 0)		fullFrame: (			LayoutFrame 				fractions: (0@0 corner: 1@1) 				offsets: (0@verticalOffset corner: 0@infoHeight negated)		).	row 		addMorph: (infoPane borderColor: Color gray)		fullFrame: (			LayoutFrame 				fractions: (0@1 corner: 1@1) 				offsets: (0@infoHeight negated corner: 0@0)		).	window 		addMorph: row		frame: nominalFractions.	row on: #mouseEnter send: #paneTransition: to: window.	row on: #mouseLeave send: #paneTransition: to: window.! !!FileContentsBrowser methodsFor: 'creation' stamp: 'RAA 1/11/2001 08:06'!openAsMorph	"Create a pluggable version of all the views for a Browser, including views and controllers."	| window aListExtent next |	window _ (SystemWindow labelled: 'later') model: self.	self packages size = 1		ifTrue: [			aListExtent _ 0.333333 @ 0.34.			self systemCategoryListIndex: 1.			window addMorph: (PluggableListMorph on: self list: #systemCategorySingleton					selected: #indexIsOne changeSelected: #indexIsOne:					menu: #packageListMenu:					keystroke: #packageListKey:from:)				frame: (0@0 extent: 1.0@0.06).			next := 0@0.06]		ifFalse: [			aListExtent _ 0.25 @ 0.4.			window addMorph: (PluggableListMorph on: self list: #systemCategoryList					selected: #systemCategoryListIndex changeSelected: #systemCategoryListIndex:					menu: #packageListMenu:					keystroke: #packageListKey:from:)				frame: (0@0 extent: aListExtent).			next := aListExtent x @ 0].	self addClassAndSwitchesTo: window at: (next extent: aListExtent) plus: 0.	next := next + (aListExtent x @ 0).	window addMorph: (PluggableListMorph on: self list: #messageCategoryList			selected: #messageCategoryListIndex changeSelected: #messageCategoryListIndex:			menu: #messageCategoryMenu:)		frame: (next extent: aListExtent).	next := next + (aListExtent x @ 0).	window addMorph: (PluggableListMorph on: self list: #messageList			selected: #messageListIndex changeSelected: #messageListIndex:			menu: #messageListMenu:			keystroke: #messageListKey:from:)		frame: (next extent: aListExtent).	self addLowerPanesTo: window at: (0@0.4 corner: 1@1) with: nil.	^ window! !ChangeList removeSelector: #buttonRowForChangeList!Browser removeSelector: #addLowerPanesTo:at:with:!Browser removeSelector: #addOptionalAnnotationsTo:at:plus:!Browser removeSelector: #addOptionalButtonsTo:at:plus:!Browser removeSelector: #buildMorphicCodePaneWith:!