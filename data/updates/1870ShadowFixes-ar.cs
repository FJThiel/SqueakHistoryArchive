'From Squeak2.8alpha of 16 February 2000 [latest update: #1869] on 18 February 2000 at 3:28:48 pm'!"Change Set:		ShadowFixes-arDate:			18 February 2000Author:			Andreas RaabFixes for shadow drawing - removing the computation of the shadowForm in HandMorph does not work as expected for compound morphs since drawing the morphs multiple times results in multiply drawing using a translucent color with the effect that shadows can look quite strange. The change set also adds a comment stating the purpose for computing the shadow form."!!Morph methodsFor: 'drawing' stamp: 'ar 2/18/2000 15:23'!shadowForm	"Return a form representing the 'shadow' of the receiver - e.g., all pixels that are occupied by the receiver are one, all others are zero."	| canvas |	canvas _ (FormCanvas extent: bounds extent depth: 1)				asShadowDrawingCanvas: Color black. "Color black represents one for 1bpp"	canvas translateBy: bounds topLeft negated		during:[:tempCanvas| self fullDrawOn: tempCanvas].	^ canvas form offset: bounds topLeft! !!HandMorph methodsFor: 'drawing' stamp: 'ar 2/18/2000 15:19'!nonCachingFullDrawOn: aCanvas	| shadowForm |	"A HandMorph has unusual drawing requirements:		1. the hand itself (i.e., the cursor) appears in front of its submorphs		2. morphs being held by the hand cast a shadow on the world/morphs below	The illusion is that the hand plucks up morphs and carries them above the world."	"Note: This version does not cache an image of the morphs being held by the hand.	 Thus, it is slower for complex morphs, but consumes less space."	submorphs isEmpty ifTrue: [^ self drawOn: aCanvas].  "just draw the hand itself"	aCanvas asShadowDrawingCanvas		translateBy: self shadowOffset during:[:shadowCanvas|		"Note: We use a shadow form here to prevent drawing		overlapping morphs multiple times using the transparent		shadow color."		shadowForm _ self shadowForm."shadowForm displayAt: shadowForm offset negated. Display forceToScreen: (0@0 extent: shadowForm extent)."		shadowCanvas paintImage: shadowForm at: shadowForm offset.  "draw shadows"	].	"draw morphs in front of shadows"	self drawSubmorphsOn: aCanvas.	self drawOn: aCanvas.  "draw the hand itself in front of morphs"! !!HandMorph methodsFor: 'drawing' stamp: 'ar 2/18/2000 15:17'!shadowForm	"Return a 1-bit shadow of my submorphs.  Assumes submorphs is not empty"	| bnds canvas |	bnds _ Rectangle merging: (submorphs collect: [:m | m bounds]).	canvas _ (FormCanvas extent: bnds extent depth: 1) 		asShadowDrawingCanvas: Color black.	canvas translateBy: bnds topLeft negated		during:[:tempCanvas| self drawSubmorphsOn: tempCanvas].	^ canvas form offset: bnds topLeft! !