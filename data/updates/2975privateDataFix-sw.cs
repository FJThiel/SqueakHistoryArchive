'From Squeak2.9alpha of 5 August 2000 [latest update: #3013] on 16 November 2000 at 2:49:18 pm'!"Change Set:		privateDataFix-swDate:			16 November 2000Author:			Scott WallaceMakes instance-specific morphs in a stack accurately feel changes in the stack's position."!!Player methodsFor: 'misc' stamp: 'sw 11/14/2000 11:20'!uninstallFrom: aPlayfield	"The receiver is about to be supplanted by another instance which is about to be installed as the current 'card' in the playfield.  Exit gracefully"	self runAllClosingScripts.	self commitCardPlayerDataFrom: aPlayfield! !!CardPlayer methodsFor: 'card data' stamp: 'sw 11/14/2000 11:21'!commitCardPlayerDataFrom: aPlayfield	"Transport data back from the morphs that may be holding it into the instance variables that must hold it when the receiver is not being viewed"	| prior itsOrigin |	itsOrigin _ aPlayfield topLeft.	self class variableDocks do:		[:aDock | aDock storeMorphDataInInstance: self].	prior _ nil.	privateMorphs _ OrderedCollection new.	self costume ifNotNil:		[self costume submorphs do:			[:aMorph | aMorph renderedMorph isShared				ifFalse:					[aMorph setProperty: #priorMorph toValue: prior.					privateMorphs add: aMorph.					aMorph delete.					aMorph position: (aMorph position - itsOrigin)].			prior _ aMorph]]! !!CardPlayer methodsFor: 'card data' stamp: 'sw 11/14/2000 12:46'!installPrivateMorphsInto: aBackground	"The receiver is being installed as the current card in a given pasteup morph being used as a background.  Install the receiver's private morphs into that playfield"	| prior originToUse |	self flag: #deferred.  "not robust if the background is showing a list view"	privateMorphs ifNotNil: [privateMorphs do:		[:aMorph |			originToUse _ aBackground topLeft.			prior _ aMorph valueOfProperty: #priorMorph ifAbsent: [nil].			aMorph position: (aMorph position + originToUse).			(prior notNil and: [aBackground submorphs includes: prior])				ifTrue:					[aBackground addMorph: aMorph after: prior]				ifFalse:					[aBackground addMorphNearBack: aMorph].		aMorph removeProperty: #priorMorph]]! !