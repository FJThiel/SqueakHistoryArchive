'From Squeakland 3.8.5976 of 25 August 2004 [latest update: #403] on 15 March 2005 at 10:44:44 pm'!"Change Set:		paramTileInTest-swDate:			15 March 2005Author:			Scott WallaceAllows a naked parameter tile to be dropped into an empty Test area of a Scriptor, whereupon it will be expanded into a boolean-valued comparator phrase and hence play nicely in the BooleanScriptEditor."!!BooleanScriptEditor methodsFor: 'dropping/grabbing' stamp: 'sw 3/15/2005 22:43'!wantsDroppedMorph: aMorph event: evt 	"Answer whether the receiver would be interested in accepting the morph"	(submorphs detect: [:m | m isAlignmentMorph] ifNone: [nil]) 		ifNotNil: [^ false].	((aMorph isKindOf: ParameterTile) and: [aMorph scriptEditor == self topEditor])		ifTrue: [^ true].	^ (aMorph isKindOf: PhraseTileMorph orOf: WatcherWrapper) 		and: [(#(#Command #Unknown) includes: aMorph resultType capitalized) not]! !!CategoryViewer methodsFor: 'support' stamp: 'sw 3/15/2005 22:33'!booleanPhraseFromPhrase: phrase	"Answer, if possible, a boolean-valued phrase derived from the phrase provided"	|  retrieverOp retrieverTile |	(phrase isKindOf: ParameterTile) ifTrue: [^ phrase booleanComparatorPhrase].	phrase isBoolean ifTrue: [^ phrase].	((scriptedPlayer respondsTo: #costume) 		and:[scriptedPlayer costume isInWorld not]) ifTrue: [^ Array new].	((retrieverTile _ phrase submorphs last) isKindOf: TileMorph) ifFalse: [^ phrase].	retrieverOp _ retrieverTile operatorOrExpression.	(Vocabulary vocabularyForType: phrase resultType)		affordsCoercionToBoolean ifTrue: 			[^ self booleanPhraseForRetrieverOfType: phrase resultType retrieverOp: retrieverOp player: phrase actualObject].	^ phrase! !!ParameterTile methodsFor: 'access' stamp: 'sw 3/15/2005 21:45'!isBoolean 	"Answer whether the receiver's type is inherently boolean"	^ self scriptEditor typeForParameter == #Boolean! !!ParameterTile methodsFor: 'access' stamp: 'sw 3/15/2005 22:36'!rowOfRightTypeFor: aLayoutMorph forActor: aPlayer	"Answer a phrase of the right type for the putative container"	| aTemporaryViewer aPhrase |	aLayoutMorph demandsBoolean ifTrue:		[aTemporaryViewer _ CategoryViewer new invisiblySetPlayer: aPlayer.		aPhrase _ aTemporaryViewer booleanPhraseFromPhrase: self.		aPhrase justGrabbedFromViewer: false.		^ aPhrase].	^ self! !!ParameterTile methodsFor: 'miscellaneous' stamp: 'sw 3/15/2005 21:55'!associatedPlayer	"Answer the player with which the receiver is associated"	^ self scriptEditor playerScripted! !!ParameterTile methodsFor: 'miscellaneous' stamp: 'sw 3/15/2005 22:37'!booleanComparatorPhrase	"Answer a boolean-valued phrase derived from a retriever (e.g. 'car's heading'); this is in order to assure that tiles laid down in a TEST area will indeed produce a boolean result"	| outerPhrase rel retrieverType |	retrieverType _ self resultType.	rel _ (Vocabulary vocabularyForType: retrieverType) comparatorForSampleBoolean.	outerPhrase _ PhraseTileMorph new setOperator: rel type: #Boolean rcvrType: retrieverType argType: retrieverType.	outerPhrase firstSubmorph addMorph: self.	outerPhrase submorphs last addMorph: (ScriptingSystem tileForArgType: retrieverType).	outerPhrase submorphs second submorphs last setBalloonText: (ScriptingSystem helpStringForOperator: rel).    	^ outerPhrase! !!ParameterTile methodsFor: 'miscellaneous' stamp: 'sw 3/15/2005 22:41'!tileRows	"Answer a list of tile rows -- in this case exactly one row -- representing the receiver."	^ Array with: (Array with: self)! !