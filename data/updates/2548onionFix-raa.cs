'From Squeak2.9alpha of 17 July 2000 [latest update: #2547] on 31 August 2000 at 2:04:00 pm'!"Change Set:		onionFixDate:			31 August 2000Author:			Bob Arning- make background of SketchEditorMorph selectable via change color... in the control menu. Default is restored to the previous onion skin."!!SketchEditorMorph methodsFor: 'initialization' stamp: 'RAA 8/31/2000 13:51'!initialize	super initialize.	color _ Color white alpha: 0.5.! !!SketchEditorMorph methodsFor: 'morphic' stamp: 'RAA 8/31/2000 13:49'!drawOn: aCanvas	"Put the painting on the display"	color isTransparent ifFalse: [		aCanvas fillRectangle: bounds color: color	].	paintingForm ifNotNil: [		aCanvas paintImage: paintingForm at: bounds origin]. ! !!SketchEditorMorph methodsFor: 'start & finish' stamp: 'RAA 8/31/2000 13:46'!deliverPainting: result evt: evt	"Done painting.  May come from resume, or from original call.  Execute user's post painting instructions in the block.  Always use this standard one.  4/21/97 tk"	| newBox newForm |	(self getActionFor: evt) == #areaFill: ifTrue: [palette setCurrentBrush: palette brush3a].	palette ifNotNil: "nil happens" [palette setAction: #paint: evt: evt].	"Get out of odd modes"	"rot _ palette getRotations."	"rotate with heading, or turn to and fro"	"palette setRotation: #normal."	result == #cancel ifTrue: [^ self cancelOutOfPainting].	"for Morphic"	"hostView rotationStyle: rot."		"rotate with heading, or turn to and fro"	newBox _ paintingForm rectangleEnclosingPixelsNotOfColor: Color transparent.	registrationPoint ifNotNil:		[registrationPoint _ registrationPoint - newBox origin]. "relative to newForm origin"	newForm _ 	Form extent: newBox extent depth: paintingForm depth.	newForm copyBits: newBox from: paintingForm at: 0@0 		clippingBox: newForm boundingBox rule: Form over fillColor: nil.	newForm isAllWhite ifTrue: [		(self valueOfProperty: #background) == true 			ifFalse: [^ self cancelOutOfPainting]].	self delete.	"so won't find me again"	dimForm ifNotNil: [dimForm delete].	newPicBlock value: newForm value: (newBox copy translateBy: bounds origin).! !!SketchEditorMorph methodsFor: 'palette handling' stamp: 'RAA 8/31/2000 14:03'!dimTheWindow	"Updated to use TranslucentColor by kfr 10/5 00"	"Do not call twice!! Installs a morph with an 'onion-skinned' copy of the pixels behind me." 	"create an 'onion-skinned' version of the stuff on the screen"	owner outermostMorphThat: [:morph | morph resumeAfterDrawError. false].	"an experiment for Nebraska to see if opaque background speeds things up""----- now using the color variable to control background	bgColor _ false ifTrue: [TranslucentColor r:1.0 g:1.0 b:1.0 alpha:0.5] ifFalse: [Color white].	dimForm _ (RectangleMorph new color: bgColor; bounds: self bounds; borderWidth: 0).	dimForm position: self position.	owner		privateAddMorph: dimForm		atIndex: (owner submorphs indexOf: self) + 1.-----"! !