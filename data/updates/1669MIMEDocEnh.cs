'From Squeak2.7alpha of October 23, 1999 [latest update: #1587] on 27 November 1999 at 2:27:47 pm'!Object subclass: #MIMEDocument	instanceVariableNames: 'mainType subType content url '	classVariableNames: 'MIMEdatabase '	poolDictionaries: ''	category: 'Network-Url'!!MIMEDocument class reorganize!('initialize-release' defaultMIMEdatabase extendedMIMEdatabase readMIMEdatabaseFrom:)('content-types' contentTypeFormData contentTypeHtml contentTypeMultipart contentTypePlainText contentTypeXml guessTypeFromExtension: guessTypeFromName: linkExtension:toType: resetMIMEdatabase)('instance creation' content: contentType:content: contentType:content:url: defaultContentType)!!MIMEDocument class methodsFor: 'initialize-release' stamp: 'bolot 5/5/1999 15:44'!defaultMIMEdatabase	| d |	(d _ Dictionary new)	at: 'html' put: 'text/html';	at: 'htm' put: 'text/html';	at: 'xml' put: 'text/xml';	at: 'txt' put: 'text/plain';	at: 'c' put: 'text/plain';	at: 'gif' put: 'image/gif';	at: 'jpg' put: 'image/jpeg';	at: 'jpeg' put: 'image/jpeg';	at: 'xbm' put: 'image/x-xbitmap';	at: 'mid' put: 'audio/midi';	at: 'doc' put: 'application/ms-word-document'.	^d! !!MIMEDocument class methodsFor: 'initialize-release' stamp: 'bolot 9/9/1999 15:41'!extendedMIMEdatabase	| d |	(d _ self defaultMIMEdatabase)	at: 'hqx' put: 'application/mac-binhex40';	at: 'cpt' put: 'application/mac-compactpro';	at: 'pdf' put: 'application/pdf';	at: 'ps' put: 'application/postscript';	at: 'ai' put: 'application/postscript';	at: 'eps' put: 'application/postscript';	at: 'rtf' put: 'text/rtf';	at: 'bin' put: 'application/octet-stream';	at: 'dms' put: 'application/octet-stream';	at: 'lha' put: 'application/octet-stream';	at: 'lzh' put: 'application/octet-stream';	at: 'exe' put: 'application/octet-stream';	at: 'class' put: 'application/octet-stream';	at: 'zip' put: 'application/zip';	at: 'gtar' put: 'application/x-gtar';	at: 'swf' put: 'application/x-shockwave-flash';	at: 'sit' put: 'application/x-stuffit';	at: 'tar' put: 'application/x-tar';	at: 'au' put: 'audio/basic';	at: 'snd' put: 'audio/basic';	at: 'mid' put: 'audio/midi';	at: 'midi' put: 'audio/midi';	at: 'mpga' put: 'audio/mpeg';	at: 'mp2' put: 'audio/mpeg';	at: 'mp3' put: 'audio/mpeg';	at: 'aiff' put: 'audio/x-aiff';	at: 'aif' put: 'audio/x-aiff';	at: 'aifc' put: 'audio/x-aiff';	at: 'rm' put: 'audio/x-pn-realaudio';	at: 'ram' put: 'audio/x-pn-realaudio';	at: 'rpm' put: 'audio/x-pn-realaudio-plugin';	at: 'ra' put: 'audio/x-realaudio';	at: 'wav' put: 'audio/x-wav';	at: 'css' put: 'text/css';	at: 'mpeg' put: 'video/mpeg';	at: 'mpg' put: 'video/mpeg';	at: 'mpe' put: 'video/mpeg';	at: 'qt' put: 'video/quicktime';	at: 'mov' put: 'video/quicktime';	at: 'avi' put: 'video/x-msvideo';	at: 'movie' put: 'video/x-sgi-movie'.	^d! !!MIMEDocument class methodsFor: 'initialize-release' stamp: 'bolot 9/9/1999 16:48'!readMIMEdatabaseFrom: someStream	| d line tokens stream |	"type/subtype    extension"	"white spaces are separators"	"apache conf file format: mime.types"	"must normalize line endings"	stream _ ReadStream on: someStream contentsOfEntireFile withSqueakLineEndings.	d _ Dictionary new.	[(line _ stream nextLine) isNil not]		whileTrue: [tokens _ line findTokens: ' 	'.			(tokens size = 2 and: [line first ~= $#])				ifTrue: [d at: tokens second put: tokens first]].	^d! !!MIMEDocument class methodsFor: 'content-types' stamp: 'bolot 5/16/1999 12:25'!contentTypeFormData	^'application/x-www-form-urlencoded'! !!MIMEDocument class methodsFor: 'content-types' stamp: 'bolot 5/16/1999 13:05'!contentTypeHtml	^'text/html'! !!MIMEDocument class methodsFor: 'content-types' stamp: 'bolot 5/16/1999 12:25'!contentTypeMultipart	^'multipart/form-data'! !!MIMEDocument class methodsFor: 'content-types' stamp: 'bolot 5/16/1999 13:05'!contentTypePlainText	^'text/plain'! !!MIMEDocument class methodsFor: 'content-types' stamp: 'bolot 5/16/1999 13:05'!contentTypeXml	^'text/xml'! !!MIMEDocument class methodsFor: 'content-types' stamp: 'bolot 11/27/1999 14:26'!guessTypeFromExtension: ext	"guesses a content type from the extension"	| extension |	extension _ ext asString.	(extension includes: $.) ifTrue: [ ^self defaultContentType].	MIMEdatabase ifNil: [self resetMIMEdatabase].	^ MIMEdatabase at: extension ifAbsent: [self defaultContentType].! !!MIMEDocument class methodsFor: 'content-types' stamp: 'bolot 11/27/1999 14:26'!guessTypeFromName: url	"guesses a content type from the url"	| extension |	extension _ url asString.	(extension includes: $.) ifFalse: [ ^self defaultContentType].	extension _ (extension findTokens: '.') last asLowercase.	MIMEdatabase ifNil: [self resetMIMEdatabase].	^ MIMEdatabase at: extension ifAbsent: [self defaultContentType].! !!MIMEDocument class methodsFor: 'content-types' stamp: 'bolot 9/9/1999 15:21'!linkExtension: ext toType: mimeType	MIMEdatabase at: ext asString put: mimeType asString! !!MIMEDocument class methodsFor: 'content-types' stamp: 'bolot 11/27/1999 14:26'!resetMIMEdatabase	MIMEdatabase _ self extendedMIMEdatabase! !