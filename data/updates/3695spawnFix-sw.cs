'From Squeak3.1alpha of 5 February 2001 [latest update: #3689] on 22 February 2001 at 6:54:55 am'!"Change Set:		spawnFix-swDate:			22 February 2001Author:			Scott WallaceFixes a bug in spawn in which the spawned browser was ill set up if spawned from a browser with a method-category selected by no method selected"!!CodeHolder methodsFor: 'commands' stamp: 'sw 2/22/2001 06:38'!spawn: aString 	"Create and schedule a spawned message category browser for the currently selected message category.  The initial text view contains the characters in aString.  In the spawned browser, preselect the current selector (if any) as the going-in assumption, though upon acceptance this will often change"	| newBrowser aCategory aClass |	(aClass _ self selectedClassOrMetaClass) isNil ifTrue:		[^ aString isEmptyOrNil ifFalse: [(Workspace new contents: aString) openLabel: 'spawned workspace']].	(aCategory _ self categoryOfCurrentMethod)		ifNil:			[self buildClassBrowserEditString: aString]		ifNotNil:			[newBrowser _ Browser new setClass: aClass selector: self selectedMessageName.			self suggestCategoryToSpawnedBrowser: newBrowser.			Browser openBrowserView: (newBrowser openMessageCatEditString: aString)		label: 'category "', aCategory, '" in ', 				newBrowser selectedClassOrMetaClassName]! !!CodeHolder methodsFor: 'misc' stamp: 'sw 2/22/2001 06:37'!suggestCategoryToSpawnedBrowser: aBrowser	"aBrowser is a message-category browser being spawned from the receiver.  Tell it what it needs to know to get its category info properly set up."	aBrowser setOriginalCategoryIndexForCurrentMethod! !!Browser methodsFor: 'accessing' stamp: 'sw 2/22/2001 06:38'!suggestCategoryToSpawnedBrowser: aBrowser	"aBrowser is a message-category browser being spawned from the receiver.  Tell it what it needs to know to get its category info properly set up."	(self isMemberOf: Browser) "yecch, but I didn't invent the browser hierarchy"		ifTrue:			[aBrowser messageCategoryListIndex: messageCategoryListIndex]		ifFalse:			[aBrowser setOriginalCategoryIndexForCurrentMethod]! !!Browser methodsFor: 'message category functions' stamp: 'sw 2/22/2001 06:54'!categoryOfCurrentMethod	"Determine the method category associated with the receiver at the current moment, or nil if none"	| aCategory |	^ super categoryOfCurrentMethod ifNil:		[(aCategory _ self messageCategoryListSelection) == ClassOrganizer allCategory					ifTrue:						[nil]					ifFalse:						[aCategory]]! !