'From Squeak3.6beta of ''4 July 2003'' [latest update: #5352] on 17 July 2003 at 1:00:27 pm'!"Change Set:		clipTextFromMorph-bfDate:			17 July 2003Author:			Bert FreudenbergAdds a 'copy text to clipboard' item to the 'copy & print' section in the halo menu. This is extremely useful for copying any text (e.g. menu items, lists, window titles etc.) from the screen. You can then paste it into an email or (*cough*) into some documentation."!!Morph methodsFor: 'menus' stamp: 'bf 7/17/2003 12:19'!addCopyItemsTo: aMenu	"Add copy-like items to the halo menu"	| subMenu |	subMenu _ MenuMorph new defaultTarget: self.	subMenu add: 'copy to paste buffer' action: #copyToPasteBuffer:.	subMenu add: 'copy text' action: #clipText.	subMenu add: 'copy Postscript' action: #clipPostscript.	subMenu add: 'print Postscript to file...' target: self selector: #printPSToFile.	aMenu add: 'copy & print...' subMenu: subMenu! !!Morph methodsFor: 'meta-actions' stamp: 'bf 7/17/2003 12:20'!buildMetaMenu: evt	"Build the morph menu. This menu has two sections. The first section contains commands that are handled by the hand; the second contains commands handled by the argument morph."	| menu |	menu _ MenuMorph new defaultTarget: self.	menu addStayUpItem.	menu add: 'grab' action: #grabMorph:.	menu add: 'copy to paste buffer' action: #copyToPasteBuffer:.	self maybeAddCollapseItemTo: menu.	menu add: 'delete' action: #dismissMorph:.	menu addLine.	menu add: 'copy text' action: #clipText.	menu add: 'copy Postscript' action: #clipPostscript.	menu add: 'print Postscript to file...' action: #printPSToFile.	menu addLine.	menu add: 'go behind' action: #goBehind.	menu add: 'add halo' action: #addHalo:.	menu add: 'duplicate' action: #maybeDuplicateMorph:.	self addEmbeddingMenuItemsTo: menu hand: evt hand.	menu add: 'resize' action: #resizeMorph:.	"Give the argument control over what should be done about fill styles"	self addFillStyleMenuItems: menu hand: evt hand.	self addDropShadowMenuItems: menu hand: evt hand.	self addLayoutMenuItems: menu hand: evt hand.	menu addUpdating: #hasClipSubmorphsString target: self selector: #changeClipSubmorphs argumentList: #().	menu addLine.	(self morphsAt: evt position) size > 1 ifTrue:		[menu add: 'submorphs...'			target: self			selector: #invokeMetaMenuAt:event:			argument: evt position].	menu addLine.	menu add: 'inspect' selector: #inspectAt:event: argument: evt position.	menu add: 'explore' action: #explore.	menu add: 'browse hierarchy' action: #browseHierarchy.	menu add: 'make own subclass' action: #subclassMorph.	menu addLine.	menu add: 'set variable name...' action: #choosePartName.	(self isMorphicModel) ifTrue:		[menu add: 'save morph as prototype' action: #saveAsPrototype.		(self ~~ self world modelOrNil) ifTrue:			 [menu add: 'become this world''s model' action: #beThisWorldsModel]].	menu add: 'save morph in file' action: #saveOnFile.	(self hasProperty: #resourceFilePath)		ifTrue: [((self valueOfProperty: #resourceFilePath) endsWith: '.morph')				ifTrue: [menu add: 'save as resource' action: #saveAsResource].				menu add: 'update from resource' action: #updateFromResource]		ifFalse: [menu add: 'attach to resource' action: #attachToResource].	menu add: 'show actions' action: #showActions.	menu addLine.	self addDebuggingItemsTo: menu hand: evt hand.	self addCustomMenuItems: menu hand: evt hand.	^ menu! !!Morph methodsFor: 'printing' stamp: 'bf 7/17/2003 12:53'!clipText	"Copy the text in the receiver or in its submorphs to the clipboard"	| content |	"My own text"	content _ self userString.	"Or in my submorphs"	content ifNil: [		| list |		list _ self allStringsAfter: nil.		list notEmpty ifTrue: [			content _ String streamContents: [:stream |				list do: [:each | stream nextPutAll: each; cr]]]].	"Did we find something?"	content		ifNil: [self flash "provide feedback"]		ifNotNil: [Clipboard clipboardText: content].! !