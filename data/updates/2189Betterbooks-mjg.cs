'From Squeak2.8alpha of 4 February 2000 [latest update: #2158] on 20 May 2000 at 12:26:33 pm'!"Change Set:		066Betterbooks-mjgDate:			15 May 2000Author:			Mark GuzdialThe attached changeset improves the PowerPoint to BookMorph translation process.  This one watches memory, and if you're running low, it writes out all the pages to disk.It goes faster if your book has a URL associated with it when you start.  When you create a new book, save the pages to disk, so that it has a URL.  Now just load from first slide of the PowerPoint presentation saved as GIF, and let it go. (And go and go and...it takes awhile :-)"!!BookMorph methodsFor: 'menu' stamp: 'mjg 5/15/2000 16:29'!loadImagesIntoBook	"PowerPoint stores GIF presentations as individual slides named Slide1, Slide2, etc.	Load these into the book.  mjg 9/99"	| directory filenumber form newpage |	directory _ ((StandardFileMenu oldFileFrom: FileDirectory default) ifNil: [^ nil]) directory.	directory isNil ifTrue: [^ nil].	"Start loading 'em up!!"	filenumber _ 1.	[directory fileExists: 'Slide',(filenumber asString)] whileTrue:		[Transcript show: 'Slide',(filenumber asString); cr.		(Smalltalk bytesLeft < 1000000) ifTrue: ["Make some room"			(self valueOfProperty: #url) == nil ifTrue:				[self savePagesOnURL]			ifFalse: [self saveAsNumberedURLs].].		form _ Form fromFileNamed: 			(directory fullNameFor: 'Slide', (filenumber asString)).		newpage _ PasteUpMorph new extent: (form extent).		newpage addMorph: (SketchMorph withForm: form).		self pages addLast: newpage.		filenumber _ filenumber + 1.].	"After adding all, delete the first page."	self goToPage: 1.	self deletePageBasic.	"Save the book"	(self valueOfProperty: #url) == nil ifTrue:				[self savePagesOnURL]			ifFalse: [self saveAsNumberedURLs].! !!Celeste class methodsFor: 'user preferences' stamp: 'sma 5/20/2000 10:18'!userTimeZone	"Answer the user's timezone string to be used when sending messages."	TimeZone isEmptyOrNil ifTrue: [self setTimeZone].	^ TimeZone ifNil: ['']! !