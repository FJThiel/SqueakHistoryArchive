'From Squeak2.9alpha of 13 June 2000 [latest update: #2915] on 12 November 2000 at 4:13:37 pm'!"Change Set:		238MemHooksRevised-goDate:			4 October 2000Author:			Georg GollmannSomewhere in the 2.9a upgrade stream the memory hogs mechanism was disabled (but not fully removed). This fileIn reintroduces it in a slightly robuster way."!!SystemDictionary methodsFor: 'memory space' stamp: 'go 10/3/2000 13:10'!lowSpaceWatcher	"Wait until the low space semaphore is signalled, then take appropriate actions."	| free |	self garbageCollectMost <= self lowSpaceThreshold ifTrue: [		self garbageCollect <= self lowSpaceThreshold ifTrue: [			"free space must be above threshold before starting low space watcher"			^ self beep]].	LowSpaceSemaphore _ Semaphore new.	self primLowSpaceSemaphore: LowSpaceSemaphore.	self primSignalAtBytesLeft: self lowSpaceThreshold.  "enable low space interrupts"	LowSpaceSemaphore wait.  "wait for a low space condition..."	self primSignalAtBytesLeft: 0.  "disable low space interrupts"	self primLowSpaceSemaphore: nil.	LowSpaceProcess _ nil.	"Note: user now unprotected until the low space watcher is re-installed"	self memoryHogs isEmpty ifFalse: [		free := self bytesLeft.		self memoryHogs do: [ :hog | hog freeSomeSpace ].		self bytesLeft > free ifTrue: [ ^ self installLowSpaceWatcher ]].	Smalltalk isMorphic			ifTrue: [CurrentProjectRefactoring currentInterruptName: 'Space is low']			ifFalse: [ScheduledControllers interruptName: 'Space is low']! !