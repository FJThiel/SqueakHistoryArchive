'From Squeak3.1alpha of 4 February 2001 [latest update: #3659] on 19 February 2001 at 6:48:35 pm'!"Change Set:		Watcher-tkDate:			19 February 2001Author:			Ted KaehlerAllows 'detailed watchers' in the EToy world to work with universal tiles.Further revision to fullCopy users.  Morph copy now does a veryDeepCopy.  All previous users of fullCopy now just create the morph again from scratch for each button.  No copying."!!Debugger methodsFor: 'initialize' stamp: 'tk 2/19/2001 17:08'!buttonRowForPreDebugWindow: aDebugWindow	| aRow aButton |	aRow _ AlignmentMorph newRow hResizing: #spaceFill.	aRow beSticky.	aRow addMorphBack: AlignmentMorph newVariableTransparentSpacer.	self preDebugButtonQuads do:			[:quad |				aButton _ SimpleButtonMorph new target: aDebugWindow.				aButton color: Color transparent; borderWidth: 1.				aButton actionSelector: quad second.				aButton label: quad first.				aButton submorphs first color: (Color colorFrom: quad third).				aButton setBalloonText: quad fourth.				aRow addMorphBack: aButton.				aRow addMorphBack: AlignmentMorph newVariableTransparentSpacer].	^ aRow! !!Morph methodsFor: 'copying' stamp: 'tk 2/19/2001 18:21'!copy	^ self veryDeepCopy! !!BookPageSorterMorph methodsFor: 'as yet unclassified' stamp: 'tk 2/19/2001 18:27'!addControls	| bb r aButton str |	r _ AlignmentMorph newRow color: Color transparent; borderWidth: 0; layoutInset: 0.	r wrapCentering: #center; cellPositioning: #topCenter; 			hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (self wrapperFor: (bb label: 'Okay';	actionSelector: #acceptSort)).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (self wrapperFor: (bb label: 'Cancel';	actionSelector: #delete)).	r addTransparentSpacerOfSize: 8 @ 0.	r addMorphBack: (self wrapperFor: (aButton _ UpdatingThreePhaseButtonMorph checkBox)).	aButton		target: self;		actionSelector: #togglePartsBinStatus;		arguments: #();		getSelector: #getPartsBinStatus.	str _ StringMorph contents: 'Parts bin'.	r addMorphBack: (self wrapperFor: str lock).	self addMorphFront: r.! !!BooklikeMorph methodsFor: 'page controls' stamp: 'tk 2/19/2001 18:34'!makePageControlsFrom: controlSpecs	"From the controlSpecs, create a set of page control and return them -- this method does *not* add the controls to the receiver."	| c col row b lastGuy |	c _ (color saturation > 0.1) ifTrue: [color slightlyLighter] ifFalse: [color slightlyDarker].	col _ AlignmentMorph newColumn.	col color: c; borderWidth: 0; layoutInset: 0.	col hResizing: #spaceFill; vResizing: #shrinkWrap; extent: 5@5.	row _ AlignmentMorph newRow.	row color: c; borderWidth: 0; layoutInset: 0.	row hResizing: #spaceFill; vResizing: #shrinkWrap; extent: 5@5.	controlSpecs do: [:spec |		spec == #spacer			ifTrue:				[row addTransparentSpacerOfSize: (10 @ 0)]			ifFalse:				[spec == #variableSpacer					ifTrue:						[row addMorphBack: AlignmentMorph newVariableTransparentSpacer]					ifFalse:						[b _ SimpleButtonMorph new target: self; borderWidth: 1; 								borderColor: Color veryLightGray; color: c.						b label: spec first;						actionSelector: spec second;						borderWidth: 0;	 					setBalloonText: spec third.						row addMorphBack: b.						(((lastGuy _ spec last asLowercase) includesSubString: 'menu') or:								[lastGuy includesSubString: 'designations'])							ifTrue: [b actWhen: #buttonDown]]]].  "pop up menu on mouseDown"		col addMorphBack: row.	^ col! !!BookMorph methodsFor: 'other' stamp: 'tk 2/19/2001 18:35'!makeMinimalControlsWithColor: aColor title: aString	| aButton aColumn aRow but |	aButton _ SimpleButtonMorph new target: self; borderColor: Color black; 				color: aColor; borderWidth: 0.	aColumn _ AlignmentMorph newColumn.	aColumn color: aButton color; borderWidth: 0; layoutInset: 0.	aColumn hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	aRow _ AlignmentMorph newRow.	aRow color: aButton color; borderWidth: 0; layoutInset: 0.	aRow hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	aRow addTransparentSpacerOfSize: 40@0.	aRow addMorphBack: (but _ aButton label: ' < ' ; actionSelector: #previousPage).		"copy is OK, since we just made it and it can't own any Players"	but setBalloonText: 'Go to previous page'.	aRow addTransparentSpacerOfSize: 82@0.	aRow addMorphBack: (StringMorph contents: aString) lock.	aRow addTransparentSpacerOfSize: 82@0.	aButton _ SimpleButtonMorph new target: self; borderColor: Color black; 				color: aColor; borderWidth: 0.	aRow addMorphBack: (but _ aButton label: ' > ' ; actionSelector: #nextPage).	but setBalloonText: 'Go to next page'.	aRow addTransparentSpacerOfSize: 40@0.	aColumn addMorphBack: aRow.	aColumn setNameTo: 'Page Controls'.		^ aColumn! !!CipherPanel methodsFor: 'menu' stamp: 'tk 2/19/2001 18:47'!buttonRow	| row aButton |	row _ AlignmentMorph newRow		color: self color;		hResizing: #shrinkWrap;		vResizing: #shrinkWrap.	#('show help' 'show hints' 'clear typing' 'enter a new cipher' 'quote from Squeak')		with: 	#(showHelpWindow showHintsWindow clearTyping enterANewCipher squeakCipher)		do: [:label :selector |			aButton _ SimpleButtonMorph new target: self.			aButton color: Color transparent; borderWidth: 1; borderColor: Color black.			aButton actionSelector: selector.			aButton label: label.			row addMorphBack: aButton.			row addTransparentSpacerOfSize: (3 @ 0)].	^ row! !!CrosticPanel methodsFor: 'menu' stamp: 'tk 2/19/2001 18:47'!buttonRow	| row aButton |	row _ AlignmentMorph newRow		color: self color;		hResizing: #shrinkWrap;		vResizing: #shrinkWrap.	#('show help' 'show errors' 'show hints' 'clear' 'open...')		with: 	#(showHelpWindow showErrors showHintsWindow clearTyping openFile)		do: [:label :selector |			aButton _ SimpleButtonMorph new target: self.			aButton color: Color transparent; borderWidth: 1; borderColor: Color black.			aButton actionSelector: selector.			aButton label: label.			row addMorphBack: aButton.			row addTransparentSpacerOfSize: (3 @ 0)].	^ row! !!FlashPlayerMorph methodsFor: 'initialize' stamp: 'tk 2/19/2001 17:47'!makeControls	| bb r loopSwitch |	r _ AlignmentMorph newRow.	r hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	bb _ SimpleButtonMorph new target: self; borderColor: #raised;				borderWidth: 2.	r addMorphBack: (bb label: 'Rewind';		actionSelector: #rewind).	bb _ SimpleButtonMorph new target: self; borderColor: #raised;				borderWidth: 2.	r addMorphBack: (bb label: 'Play';		actionSelector: #startPlaying).	bb _ SimpleButtonMorph new target: self; borderColor: #raised;				borderWidth: 2.	r addMorphBack: (bb label: 'Pause';		actionSelector: #stopPlaying).	bb _ SimpleButtonMorph new target: self; borderColor: #raised;				borderWidth: 2.	r addMorphBack: (bb label: 'Next';		actionSelector: #stepForward).	bb _ SimpleButtonMorph new target: self; borderColor: #raised;				borderWidth: 2.	r addMorphBack: (bb label: 'Prev';		actionSelector: #stepBackward).	loopSwitch _ SimpleSwitchMorph new		borderWidth: 2;		label: 'Loop';		actionSelector: #loopFrames:;		target: self;		setSwitchState: self loopFrames.	r addMorphBack: loopSwitch.	loopSwitch _ SimpleSwitchMorph new		borderWidth: 2;		label: 'Defer';		actionSelector: #toggleDeferred;		target: self;		setSwitchState: self deferred.	r addMorphBack: loopSwitch.	bb _ SimpleButtonMorph new target: self; borderColor: #raised;				borderWidth: 2.	r addMorphBack: (bb label: 'Fastest'; 	actionSelector: #drawFastest).	bb _ SimpleButtonMorph new target: self; borderColor: #raised;				borderWidth: 2.	r addMorphBack: (bb label: 'Medium';	actionSelector: #drawMedium).	bb _ SimpleButtonMorph new target: self; borderColor: #raised;				borderWidth: 2.	r addMorphBack: (bb label: 'Nicest';		actionSelector: #drawNicest).	bb _ SimpleButtonMorph new target: self; borderColor: #raised;				borderWidth: 2.	r addMorphBack: (bb label: '+10';		actionSelector: #jump10).	^ self world activeHand attachMorph: r! !!FlashSorterMorph methodsFor: 'initialization' stamp: 'tk 2/19/2001 17:48'!makeControls	| bb r |	bb _ SimpleButtonMorph new		target: self;		borderColor: #raised;		borderWidth: 2.	r _ AlignmentMorph newRow.	r hResizing: #spaceFill; vResizing: #spaceFill; layoutInset: 2.	r addMorphBack: (bb label: 'Make movie';		actionSelector: #makeMovie).	^r! !!GraphicalMenu methodsFor: 'as yet unclassified' stamp: 'tk 2/19/2001 18:23'!initializeFor: aTarget withForms: formList coexist: aBoolean	" World primaryHand attachMorph: (GraphicalMenu new initializeFor: nil 		withForms: Form allInstances coexist: true) "	| buttons bb anIndex buttonCage imageWrapper |	target _ aTarget.	coexistWithOriginal _ aBoolean.	color _ Color white.	borderColor _ Color blue darker.	borderWidth _ 1.	formChoices _ formList.	currentIndex _ 1.	self hResizing: #shrinkWrap; vResizing: #shrinkWrap.	buttons _ AlignmentMorph newRow.	buttons borderWidth: 0; layoutInset: 0.	buttons hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	buttons wrapCentering: #topLeft.	buttonCage _ AlignmentMorph newColumn.	buttonCage hResizing: #shrinkWrap; vResizing: #spaceFill.	buttonCage addTransparentSpacerOfSize: (0 @ 10).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	buttons addMorphBack: (bb label: 'Prev';		actionSelector: #downArrowHit; actWhen: #whilePressed).	buttons addTransparentSpacerOfSize: (9@0).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	buttons addMorphBack: (bb label: 'Next';			actionSelector: #upArrowHit; actWhen: #whilePressed).	buttons addTransparentSpacerOfSize: (5@0).	buttons submorphs last color: Color white.	buttonCage addMorphBack: buttons.	buttonCage addTransparentSpacerOfSize: (0 @ 12).	buttons _ AlignmentMorph newRow.	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	buttons addMorphBack: (bb label: 'OK';	actionSelector: #okay).	buttons addTransparentSpacerOfSize: (5@0).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	buttons addMorphBack: (bb label: 'Cancel';	actionSelector: #cancel).	buttonCage addMorphBack: buttons.	buttonCage addTransparentSpacerOfSize: (0 @ 10).	self addMorphFront: buttonCage.	imageWrapper _ Morph new color: Color transparent; extent: 102 @ 82.	imageWrapper addMorphBack: (formDisplayMorph _ ImageMorph new extent: 100 @ 100).	self addMorphBack: imageWrapper.	target ifNotNil: [(anIndex _ formList indexOf: target form ifAbsent: [nil]) ifNotNil:		[currentIndex _ anIndex]].	self updateThumbnail! !!GraphicalDictionaryMenu methodsFor: 'as yet unclassified' stamp: 'tk 2/19/2001 18:24'!initializeFor: aTarget fromDictionary: aDictionary	|  imageWrapper anIndex aButton controlsWrapper asm |	self listDirection: #topToBottom.	self addMorphBack: (controlsWrapper _ AlignmentMorph newRow).	self baseDictionary: aDictionary.	target _ aTarget.	coexistWithOriginal _ true.	color _ Color white.	borderColor _ Color blue darker.	borderWidth _ 1.	self hResizing: #shrinkWrap; vResizing: #shrinkWrap.	controlsWrapper borderWidth: 0; layoutInset: 0; hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	controlsWrapper wrapCentering: #topLeft; color: Color white; vResizing: #spaceFill.	controlsWrapper addTransparentSpacerOfSize: (18@0).	controlsWrapper addMorphBack: (IconicButton new borderWidth: 0;			labelGraphic: (ScriptingSystem formAtKey: 'Menu'); color: Color transparent; 			actWhen: #buttonDown;			actionSelector: #showMenu; target: self;			setBalloonText: 'menu').	controlsWrapper  addTransparentSpacerOfSize: (14@0).	aButton _ SimpleButtonMorph new target: self; borderColor: Color black.	controlsWrapper addMorphBack: (aButton		label: 'Prev';		actionSelector: #downArrowHit;		actWhen: #whilePressed;		setBalloonText: 'show previous picture';		yourself).	controlsWrapper addTransparentSpacerOfSize: (15@0).	aButton _ SimpleButtonMorph new target: self; borderColor: Color black.	controlsWrapper addMorphBack: (aButton label: 'Next';			actionSelector: #upArrowHit; actWhen: #whilePressed; 		setBalloonText: 'show next pictutre').	self addMorphBack: controlsWrapper.	self addTransparentSpacerOfSize: (0 @ 12).	self addMorphBack:  (asm _ UpdatingStringMorph new contents: ' '; target: self; putSelector: #renameGraphicTo:; getSelector: #truncatedNameOfGraphic; useStringFormat).	asm setBalloonText: 'The name of the current graphic'. 	self addTransparentSpacerOfSize: (0 @ 12).	self addMorphBack: (AlignmentMorph newRow height: 4; borderWidth: 0; color: Color black).	imageWrapper _ Morph new color: Color transparent; extent: 190 @ 82.	imageWrapper addMorphBack: (formDisplayMorph _ ImageMorph new extent: 100 @ 100).	self addMorphBack: imageWrapper.	target ifNotNil: [(anIndex _ formChoices indexOf: target form ifAbsent: [nil]) ifNotNil:		[currentIndex _ anIndex]].	self updateThumbnail! !!KeyboardMorphForInput methodsFor: 'initialization' stamp: 'tk 2/19/2001 18:20'!addRecordingControls	| button switch playRow durRow articRow modRow |	"Add chord, rest and delete buttons"	playRow _ AlignmentMorph newRow.	playRow color: color; borderWidth: 0; layoutInset: 0.	playRow hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	playRow addMorphBack: (switch label: 'chord'; actionSelector: #buildChord:).	button _ SimpleButtonMorph new target: self;		borderColor: #raised; borderWidth: 2; color: color.	playRow addMorphBack: (button label: '          rest          '; actionSelector: #emitRest).	button _ SimpleButtonMorph new target: self;		borderColor: #raised; borderWidth: 2; color: color.	playRow addMorphBack: (button label: 'del'; actionSelector: #deleteNotes).	self addMorph: playRow.	playRow align: playRow bounds topCenter			with: self bounds bottomCenter.	"Add note duration buttons"	durRow _ AlignmentMorph newRow.	durRow color: color; borderWidth: 0; layoutInset: 0.	durRow hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	durRow addMorphBack: (switch label: 'whole';				actionSelector: #duration:onOff:; arguments: #(1)).	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	durRow addMorphBack: (switch label: 'half';				actionSelector: #duration:onOff:; arguments: #(2)).	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	durRow addMorphBack: (switch label: 'quarter';				actionSelector: #duration:onOff:; arguments: #(4)).	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	durRow addMorphBack: (switch label: 'eighth';				actionSelector: #duration:onOff:; arguments: #(8)).	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	durRow addMorphBack: (switch label: 'sixteenth';				actionSelector: #duration:onOff:; arguments: #(16)).	self addMorph: durRow.	durRow align: durRow bounds topCenter			with: playRow bounds bottomCenter.	"Add note duration modifier buttons"	modRow _ AlignmentMorph newRow.	modRow color: color; borderWidth: 0; layoutInset: 0.	modRow hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	modRow addMorphBack: (switch label: 'dotted';				actionSelector: #durMod:onOff:; arguments: #(dotted)).	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	modRow addMorphBack: (switch label: 'normal';				actionSelector: #durMod:onOff:; arguments: #(normal)).	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	modRow addMorphBack: (switch label: 'triplets';				actionSelector: #durMod:onOff:; arguments: #(triplets)).	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	modRow addMorphBack: (switch label: 'quints';				actionSelector: #durMod:onOff:; arguments: #(quints)).	self addMorph: modRow.	modRow align: modRow bounds topCenter			with: durRow bounds bottomCenter.	"Add articulation buttons"	articRow _ AlignmentMorph newRow.	articRow color: color; borderWidth: 0; layoutInset: 0.	articRow hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	articRow addMorphBack: (switch label: 'legato';				actionSelector: #articulation:onOff:; arguments: #(legato)).	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	articRow addMorphBack: (switch label: 'normal';				actionSelector: #articulation:onOff:; arguments: #(normal)).	switch _ SimpleSwitchMorph new target: self; borderWidth: 2;		offColor: color; onColor: (Color r: 1.0 g: 0.6 b: 0.6); setSwitchState: false.	articRow addMorphBack: (switch label: 'staccato';				actionSelector: #articulation:onOff:; arguments: #(staccato)).	self addMorph: articRow.	articRow align: articRow bounds topCenter			with: modRow bounds bottomCenter.	self bounds: (self fullBounds expandBy: (0@0 extent: 0@borderWidth))! !!MidiInputMorph methodsFor: 'as yet unclassified' stamp: 'tk 2/19/2001 17:51'!makeControls	| bb r reverbSwitch onOffSwitch |	bb _ SimpleButtonMorph new		target: self;		borderColor: #raised;		borderWidth: 2;		color: color.	r _ AlignmentMorph newRow.	r color: bb color; borderWidth: 0; layoutInset: 0.	r hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	r addMorphBack: (		bb label: '<>';			actWhen: #buttonDown;			actionSelector: #invokeMenu).	onOffSwitch _ SimpleSwitchMorph new		offColor: color;		onColor: (Color r: 1.0 g: 0.6 b: 0.6);		borderWidth: 2;		label: 'On';		actionSelector: #toggleOnOff;		target: self;		setSwitchState: false.	r addMorphBack: onOffSwitch.	reverbSwitch _ SimpleSwitchMorph new		offColor: color;		onColor: (Color r: 1.0 g: 0.6 b: 0.6);		borderWidth: 2;		label: 'Reverb Disable';		actionSelector: #disableReverb:;		target: self;		setSwitchState: SoundPlayer isReverbOn not.	r addMorphBack: reverbSwitch.	^ r! !!MidiInputMorph methodsFor: 'as yet unclassified' stamp: 'tk 2/19/2001 18:43'!panAndVolControlsFor: channelIndex	| volSlider panSlider c r middleLine |	volSlider _ SimpleSliderMorph new		color: color;		extent: 101@2;		target: midiSynth;		arguments: (Array with: channelIndex);		actionSelector: #volumeForChannel:put:;		minVal: 0.0;		maxVal: 1.0;		adjustToValue: (midiSynth volumeForChannel: channelIndex).	panSlider _ SimpleSliderMorph new		color: color;		extent: 101@2;		target: midiSynth;		arguments: (Array with: channelIndex);		actionSelector: #panForChannel:put:;		minVal: 0.0;		maxVal: 1.0;				adjustToValue: (midiSynth panForChannel: channelIndex).	c _ AlignmentMorph newColumn		color: color;		layoutInset: 0;		wrapCentering: #center; cellPositioning: #topCenter;		hResizing: #spaceFill;		vResizing: #shrinkWrap.	middleLine _ Morph new  "center indicator for pan slider"		color: (Color r: 0.4 g: 0.4 b: 0.4);		extent: 1@(panSlider height - 4);		position: panSlider center x@(panSlider top + 2).	panSlider addMorphBack: middleLine.	r _ self makeRow.	r addMorphBack: (StringMorph contents: '0').	r addMorphBack: volSlider.	r addMorphBack: (StringMorph contents: '10').	c addMorphBack: r.	r _ self makeRow.	r addMorphBack: (StringMorph contents: 'L').	r addMorphBack: panSlider.	r addMorphBack: (StringMorph contents: 'R').	c addMorphBack: r.	^ c! !!Player methodsFor: 'slots-user' stamp: 'tk 2/19/2001 16:59'!tearOffFancyWatcherFor: aSlotName	| aWatcher aTile getSel aLine aColor aTower precision ms slotMsg |	"Create 'Player3 heading = 43' as in independent entity.  It keeps up with the truth, and may be edited to change the variable."	aColor _ Color r: 0.387 g: 0.581 b: 1.0.	aTile _ NumericReadoutTile new typeColor: aColor.	aWatcher _ UpdatingStringMorph new.	(precision _ self defaultFloatPrecisionFor: 		(getSel _ ScriptingSystem getterSelectorFor: aSlotName)) ~= 1 			ifTrue: [aWatcher floatPrecision: precision].	aWatcher growable: true;		getSelector: getSel;		putSelector: (ScriptingSystem setterSelectorFor: aSlotName).	aWatcher target: self.	aTile addMorphBack: aWatcher.	aTile addArrows.	aTile setLiteralTo: (self perform: getSel) width: 30.Preferences universalTiles 	ifTrue: [		ms _ MessageSend receiver: self selector: aSlotName asSymbol arguments: #().		slotMsg _ ms asTilesIn: self class.		ms _ MessageSend receiver: 3 selector: #= asSymbol arguments: #(5).		aLine _ ms asTilesIn: self class.		aLine firstSubmorph delete.		aLine addMorphFront: slotMsg.		aLine lastSubmorph delete.		aLine lastSubmorph delete.		aLine color: aColor.		aLine addMorphBack: aTile.		aLine cellPositioning: #leftCenter]	ifFalse: [		aLine _ AlignmentMorph newRow vResizing: #shrinkWrap; color: aColor.		aLine layoutInset: -1.		aLine borderWidth: 1; borderColor: aColor darker.		aLine addMorphBack: 			(self tileReferringToSelf borderWidth: 0; typeColor: aColor; 				color: aColor; bePossessive).		aLine addTransparentSpacerOfSize: (4@0).		aTower _ AlignmentMorph newColumn color: aColor.		aTower addTransparentSpacerOfSize: (0 @ 1).		aTower addMorphBack: 			(StringMorph contents: aSlotName, ' = ' font: ScriptingSystem fontForTiles).		aLine addMorphBack: aTower.		aLine addMorphBack: aTile].	aWatcher step; fitContents.	self currentHand attachMorph: aLine.! !!Preferences class methodsFor: 'parameters' stamp: 'tk 2/19/2001 17:40'!editAnnotations	"Preferences editAnnotations"	| aPanel ins outs current aMorph aWindow aButton info pair |	Smalltalk isMorphic		ifFalse:			[^ self inform: 'Sorry, you must be in a morphicproject to use this feature.'].	aPanel _ AlignmentMorph newRow extent: 300 @ 100.	ins _ AlignmentMorph newColumn extent: 150 @ 100.	ins color: Color green muchLighter.	ins enableDrop: true; beSticky.	outs _ AlignmentMorph newColumn extent: 150 @ 100.	outs color: Color red muchLighter.	outs enableDrop: true; beSticky.	aPanel addMorph: outs; addMorphFront: ins.	outs position: (ins position + (200 @ 0)).	current _ self defaultAnnotationRequests.	info _ self annotationInfo.	current do:		[:sym | pair _ info detect: [:aPair | aPair first == sym].		aMorph _ StringMorph new contents: pair first.		aMorph setBalloonText: pair last.		aMorph enableDrag: true.		aMorph			on: #startDrag			send: #startDrag:with:			to: aMorph.		ins addMorphBack: aMorph].	info do:		[:aPair | 			(current includes: aPair first) 				ifFalse:					[aMorph _ StringMorph new contents: aPair first.					aMorph setBalloonText: aPair last.					aMorph enableDrag: true.					aMorph						on: #startDrag						send: #startDrag:with:						to: aMorph.					outs addMorph: aMorph]].	aPanel layoutChanged.	aWindow _ SystemWindowWithButton new setLabel: 'Annotations'.	aButton _ SimpleButtonMorph new target: Preferences;		actionSelector: #acceptAnnotationsFrom:; arguments: (Array with: aWindow); label: 'apply'; borderWidth: 0; borderColor: Color transparent; color: Color transparent.	aButton submorphs first color: Color blue.	aButton setBalloonText: 'After moving all the annotations you want to the left (green) side, and all the ones you do NOT want to the right (pink) side, hit this "apply" button to have your choices take effect.'.	aWindow buttonInTitle: aButton; adjustExtraButton.	self currentWorld addMorphCentered: (aPanel wrappedInWindow: aWindow).	aWindow activateAndForceLabelToShow! !!Preferences class methodsFor: 'window colors' stamp: 'tk 2/19/2001 17:12'!windowSpecificationPanel	"Preferences windowSpecificationPanel"	| aPanel buttonRow aButton aRow aSwatch aColor aWindow aMiniWorld |	aPanel _ AlignmentMorph newColumn hResizing: #shrinkWrap; vResizing: #shrinkWrap;		layoutInset: 0.	aPanel addMorph: (buttonRow _ AlignmentMorph newRow color: (aColor _ Color tan lighter)).		buttonRow addTransparentSpacerOfSize: 2@0.	buttonRow addMorphBack: (SimpleButtonMorph new label: '?'; target: self; actionSelector: #windowColorHelp; setBalloonText: 'Click for an explanation of this panel'; color: Color veryVeryLightGray; yourself).	buttonRow addTransparentSpacerOfSize: 8@0.	#(	('Bright' 	installBrightWindowColors	yellow					'Use standard bright colors for all windows.')		('Pastel'		installPastelWindowColors	paleMagenta					'Use standard pastel colors for all windows.')		('White'	installUniformWindowColors		white					'Use white backgrounds for all standard windows.')) do:		[:quad |			aButton _ (SimpleButtonMorph new target: self)				label: quad first;				actionSelector: quad second;				color: (Color colorFrom: quad third);				setBalloonText: quad fourth;				yourself.			buttonRow addMorphBack: aButton.			buttonRow addTransparentSpacerOfSize: 10@0].	self windowColorClasses do:		[:aClassName | 			aRow _ AlignmentMorph newRow color: aColor.			aSwatch _ ColorSwatch new				target: self;				getSelector: #windowColorFor:;				putSelector: #setWindowColorFor:to:;				argument: aClassName;				extent: (40 @ 20);				yourself.			aRow addMorphFront: aSwatch.			aRow addTransparentSpacerOfSize: (12 @ 1).			aRow addMorphBack: (StringMorph contents: aClassName font: TextStyle defaultFont).			aPanel addMorphBack: aRow].	 Smalltalk isMorphic                ifTrue:                        [buttonRow _ AlignmentMorph newRow color: aColor.					buttonRow addTransparentSpacerOfSize: 25@0.					aButton _ SimpleButtonMorph new target: self.					aButton color: Color tan muchLighter.					aButton label: 'Update Tools Flap'; 						target: Utilities; actionSelector: #replaceToolsFlap.					buttonRow addMorphBack: aButton.					aButton setBalloonText: 'Press here to place tools which use the above window-color choices  into the Tools flap.'.					aPanel addMorphBack: buttonRow.					aWindow _ aPanel wrappedInWindowWithTitle: 'Window Colors'.					self currentWorld addMorphCentered: aWindow.					aWindow activateAndForceLabelToShow ]                ifFalse:                        [(aMiniWorld _ MVCWiWPasteUpMorph newWorldForProject: nil)						addMorph: aPanel.                           aMiniWorld startSteppingSubmorphsOf: aPanel.                        MorphWorldView openOn: aMiniWorld                                label: 'Window Colors'                                extent: aMiniWorld fullBounds extent]! !!ProjectSorterMorph methodsFor: 'as yet unclassified' stamp: 'tk 2/19/2001 18:30'!addControls	| b r partsBinButton newButton |	newButton _ ImageMorph new image: (World project makeThumbnail scaledToSize: 24@18).	newButton on: #mouseDown send: #insertNewProject: to: self.	newButton setBalloonText: 'Make a new Project'.	(partsBinButton _ UpdatingThreePhaseButtonMorph checkBox)		target: self;		actionSelector: #togglePartsBinStatus;		arguments: #();		getSelector: #getPartsBinStatus.	(r _ AlignmentMorph newRow)		color: Color transparent;		borderWidth: 0;		layoutInset: 0;		wrapCentering: #center;		cellPositioning: #topCenter;		hResizing: #shrinkWrap;		vResizing: #shrinkWrap;		extent: 5@5.	b _ SimpleButtonMorph new target: self; color: self myColor darker;			borderColor: Color black.	r addMorphBack: (self wrapperFor: (b label: 'Okay';	actionSelector: #acceptSort)).	b _ SimpleButtonMorph new target: self; color: self myColor darker;			borderColor: Color black.	r addMorphBack: (self wrapperFor: (b label: 'Cancel';	actionSelector: #delete));		addMorphBack: (self wrapperFor: (newButton));		addTransparentSpacerOfSize: 8 @ 0;		addMorphBack: (self wrapperFor: partsBinButton);		addMorphBack: (self wrapperFor: (StringMorph contents: 'Parts bin') lock).	self addMorphFront: r.! !!ScorePlayerMorph methodsFor: 'initialization' stamp: 'tk 2/19/2001 18:46'!onScorePlayer: aScorePlayer title: scoreName	| divider col r |	scorePlayer _ aScorePlayer.	scorePlayer ifNotNil:		[scorePlayer  reset.		instrumentSelector _ Array new: scorePlayer score tracks size].	self removeAllMorphs.	self addMorphBack: self makeControls.	scorePlayer ifNil: [^ self].	r _ self makeRow		hResizing: #shrinkWrap;		vResizing: #shrinkWrap.	r addMorphBack: self rateControl;		addMorphBack: (Morph newBounds: (0@0 extent: 20@0) color: Color transparent);		addMorphBack: self volumeControl.	self addMorphBack: r.	self addMorphBack: self scrollControl.	col _ AlignmentMorph newColumn color: color; layoutInset: 0.	self addMorphBack: col.	1 to: scorePlayer trackCount do: [:trackIndex |		divider _ AlignmentMorph new			extent: 10@1;			borderWidth: 1;			layoutInset: 0;			borderColor: #raised;			color: color;			hResizing: #spaceFill;			vResizing: #rigid.		col addMorphBack: divider.		col addMorphBack: (self trackControlsFor: trackIndex)].	LastMIDIPort ifNotNil: [		"use the most recently set MIDI port"		scorePlayer openMIDIPort: LastMIDIPort].! !!ScorePlayerMorph methodsFor: 'layout' stamp: 'tk 2/19/2001 17:56'!makeControls	| bb r reverbSwitch repeatSwitch |	r _ AlignmentMorph newRow.	r color: color; borderWidth: 0; layoutInset: 0.	r hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	bb _ SimpleButtonMorph new target: self; borderColor: #raised;			borderWidth: 2; color: color.	r addMorphBack: (bb label: '<>'; actWhen: #buttonDown;												actionSelector: #invokeMenu).	bb _ SimpleButtonMorph new target: self; borderColor: #raised;			borderWidth: 2; color: color.	r addMorphBack: (bb label: 'Piano Roll';		actionSelector: #makePianoRoll).	bb _ SimpleButtonMorph new target: self; borderColor: #raised;			borderWidth: 2; color: color.	r addMorphBack: (bb label: 'Rewind';		actionSelector: #rewind).	bb _ SimpleButtonMorph new target: scorePlayer; borderColor: #raised;			borderWidth: 2; color: color.	r addMorphBack: (bb label: 'Play';			actionSelector: #resumePlaying).	bb _ SimpleButtonMorph new target: scorePlayer; borderColor: #raised;			borderWidth: 2; color: color.	r addMorphBack: (bb label: 'Pause';			actionSelector: #pause).	reverbSwitch _ SimpleSwitchMorph new		offColor: color;		onColor: (Color r: 1.0 g: 0.6 b: 0.6);		borderWidth: 2;		label: 'Reverb Disable';		actionSelector: #disableReverb:;		target: scorePlayer;		setSwitchState: SoundPlayer isReverbOn not.	r addMorphBack: reverbSwitch.	scorePlayer ifNotNil:		[repeatSwitch _ SimpleSwitchMorph new			offColor: color;			onColor: (Color r: 1.0 g: 0.6 b: 0.6);			borderWidth: 2;			label: 'Repeat';			actionSelector: #repeat:;			target: scorePlayer;			setSwitchState: scorePlayer repeat.		r addMorphBack: repeatSwitch].	^ r! !!ScorePlayerMorph methodsFor: 'layout' stamp: 'tk 2/19/2001 18:44'!panAndVolControlsFor: trackIndex	| volSlider panSlider c r middleLine pianoRollColor |	pianoRollColor _ (Color wheel: scorePlayer score tracks size) at: trackIndex.	volSlider _ SimpleSliderMorph new		color: color;		sliderColor: pianoRollColor;		extent: 101@2;		target: scorePlayer;		arguments: (Array with: trackIndex);		actionSelector: #volumeForTrack:put:;		minVal: 0.0;		maxVal: 1.0;		adjustToValue: (scorePlayer volumeForTrack: trackIndex).	panSlider _ SimpleSliderMorph new		color: color;		sliderColor: pianoRollColor;		extent: 101@2;		target: scorePlayer;		arguments: (Array with: trackIndex);		actionSelector: #panForTrack:put:;		minVal: 0.0;		maxVal: 1.0;				adjustToValue: (scorePlayer panForTrack: trackIndex).	c _ AlignmentMorph newColumn		color: color;		layoutInset: 0;		wrapCentering: #center; cellPositioning: #topCenter;		hResizing: #spaceFill;		vResizing: #shrinkWrap.	middleLine _ Morph new  "center indicator for pan slider"		color: (Color r: 0.4 g: 0.4 b: 0.4);		extent: 1@(panSlider height - 4);		position: panSlider center x@(panSlider top + 2).	panSlider addMorphBack: middleLine.	r _ self makeRow.	r addMorphBack: (StringMorph contents: '0').	r addMorphBack: volSlider.	r addMorphBack: (StringMorph contents: '10').	c addMorphBack: r.	r _ self makeRow.	r addMorphBack: (StringMorph contents: 'L').	r addMorphBack: panSlider.	r addMorphBack: (StringMorph contents: 'R').	c addMorphBack: r.	^ c! !!SoundDemoMorph methodsFor: 'as yet unclassified' stamp: 'tk 2/19/2001 17:49'!makeControls	| bb r cc |	cc _ Color black.	r _ AlignmentMorph newRow.	r color: cc; borderWidth: 0; layoutInset: 0.	r hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	bb _ SimpleButtonMorph new target: self; borderColor: cc.	r addMorphBack: (bb label: 'V1';			actionSelector: #playV1).	bb _ SimpleButtonMorph new target: self; borderColor: cc.	r addMorphBack: (bb label: 'V2';			actionSelector: #playV2).	bb _ SimpleButtonMorph new target: self; borderColor: cc.	r addMorphBack: (bb label: 'V3';			actionSelector: #playV3).	bb _ SimpleButtonMorph new target: self; borderColor: cc.	r addMorphBack: (bb label: 'All';			actionSelector: #playAll).	bb _ SimpleButtonMorph new target: self; borderColor: cc.	r addMorphBack: (bb label: 'Stop';		actionSelector: #stopSound).	^ r! !!SoundSequencerMorph methodsFor: 'as yet unclassified' stamp: 'tk 2/19/2001 18:14'!makeControlPanel	| bb cc |	cc _ Color black.	bb _ SimpleButtonMorph new target: self; borderColor: cc.	controlPanel _ AlignmentMorph newRow.	bb _ SimpleButtonMorph new target: self; borderColor: cc.	controlPanel color: bb color; borderWidth: 0; layoutInset: 0.	controlPanel hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	bb _ SimpleButtonMorph new target: self; borderColor: cc.	controlPanel addMorphBack: (bb label: 'reset';	actionSelector: #reset).	bb _ SimpleButtonMorph new target: self; borderColor: cc.	controlPanel addMorphBack: (bb label: 'stop';		actionSelector: #stop).	bb _ SimpleButtonMorph new target: self; borderColor: cc.	controlPanel addMorphBack: (bb label: 'play';	actionSelector: #play).! !!TabSorterMorph methodsFor: 'as yet unclassified' stamp: 'tk 2/19/2001 18:28'!addControls	| b r |	b _ SimpleButtonMorph new target: self; borderColor: Color black.	r _ AlignmentMorph newRow.	r color: b color; borderWidth: 0; layoutInset: 0.	r hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	r wrapCentering: #topLeft.	r addMorphBack: (b label: 'Okay';	actionSelector: #acceptSort).	b _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (b label: 'Cancel';	actionSelector: #cancelSort).	self addMorphFront: r.! !!Utilities class methodsFor: 'flaps' stamp: 'tk 2/19/2001 17:42'!addProjectNavigationButtonsTo: aMorph	"Add prev, next, and go-to buttons at the top of aMorph"	| aButton aFont bb |	bb _ SimpleButtonMorph new target: Project.	bb actionSelector: #returnToPreviousProject.	bb beTransparent.	aFont _ StrikeFont familyName: #ComicBold size: 24.	aButton _ SimpleButtonMorph new target: Project.	aButton actionSelector: #returnToPreviousProject.	aButton beTransparent.	aButton label: '<' font: aFont; borderWidth: 0.	aButton firstSubmorph color: Color red lighter.	aButton position: 30 @ 12.	aButton setBalloonText: 'previous project'.	aMorph addMorph: aButton.	aButton _ SimpleButtonMorph new target: Project.	aButton actionSelector: #advanceToNextProject.	aButton beTransparent.	aButton label: '>' font: aFont; borderWidth: 0.	aButton firstSubmorph color: Color red lighter.	aButton position: 150 @ 14.	aButton setBalloonText: 'next project'.	aMorph addMorph: aButton.	aButton _ SimpleButtonMorph new target: Project.	aButton actWhen: #buttonDown.	aButton actionSelector: #jumpToProject.	aButton beTransparent.	aButton label: 'Go...' font: (StrikeFont familyName: #ComicBold size: 19); borderWidth: 0.	aButton position: 78 @ 16.	aButton firstSubmorph color: Color red lighter.	aButton setBalloonText: 'go directly to a project'.	aMorph addMorph: aButton! !!WaveEditor methodsFor: 'initialization' stamp: 'tk 2/19/2001 18:26'!addControls	| slider bb r m |	r _ AlignmentMorph newRow.	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r color: bb color; borderWidth: 0; layoutInset: 0.	r hResizing: #shrinkWrap; vResizing: #shrinkWrap; extent: 5@5.	r wrapCentering: #topLeft.	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (bb label: 'X';					actionSelector: #delete).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (bb label: '<>'; actWhen: #buttonDown;															actionSelector: #invokeMenu).	r addMorphBack: (bb label: 'Play';				actionSelector: #play).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (bb label: 'Play Before';		actionSelector: #playBeforeCursor).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (bb label: 'Play After';			actionSelector: #playAfterCursor).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (bb label: 'Play Loop';			actionSelector: #playLoop).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (bb label: 'Test';				actionSelector: #playTestNote).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (bb label: 'Save';				actionSelector: #saveInstrument).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (bb label: 'Set Loop End';		actionSelector: #setLoopEnd).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (bb label: 'One Cycle';			actionSelector: #setOneCycle).	bb _ SimpleButtonMorph new target: self; borderColor: Color black.	r addMorphBack: (bb label: 'Set Loop Start';		actionSelector: #setLoopStart).	self addMorphBack: r.	r _ AlignmentMorph newRow.	r color: self color; borderWidth: 0; layoutInset: 0.	r hResizing: #spaceFill; vResizing: #rigid; extent: 5@20; wrapCentering: #center; cellPositioning: #leftCenter.	m _ StringMorph new contents: 'Index: '.	r addMorphBack: m.	m _ UpdatingStringMorph new		target: graph; getSelector: #cursor; putSelector: #cursor:;		growable: false; width: 71; step.	r addMorphBack: m.	m _ StringMorph new contents: 'Value: '.	r addMorphBack: m.	m _ UpdatingStringMorph new		target: graph; getSelector: #valueAtCursor; putSelector: #valueAtCursor:;		growable: false; width: 50; step.	r addMorphBack: m.	slider _ SimpleSliderMorph new		color: color;		extent: 200@2;		target: self;		actionSelector: #scrollTime:.	r addMorphBack: slider.	m _ Morph new color: r color; extent: 10@5.  "spacer"	r addMorphBack: m.	m _ UpdatingStringMorph new		target: graph; getSelector: #startIndex; putSelector: #startIndex:;		width: 40; step.	r addMorphBack: m.	self addMorphBack: r.! !