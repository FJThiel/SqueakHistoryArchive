'From Squeak2.8alpha of 4 February 2000 [latest update: #2210] on 3 June 2000 at 10:15:25 pm'!"Change Set:		118FasterSenders-sqrDate:			31 May 2000Author:			Andres Valloud25% faster senders.  [Code provided by AV even if I edited every method.  I just added the code for the non-deep-array-seeking case --sma]"!!Array methodsFor: 'private' stamp: 'sma 6/3/2000 21:39'!hasLiteral: literal	"Answer true if literal is identical to any literal in this array, even 	if imbedded in further array structure. This method is only intended 	for private use by CompiledMethod hasLiteralSymbol:"	| lit |	1 to: self size do: 		[:index | 		(lit _ self at: index) == literal ifTrue: [^ true].		(lit class == Array and: [lit hasLiteral: literal]) ifTrue: [^ true]].	^ false! !!Behavior methodsFor: 'testing method dictionary' stamp: 'sma 6/3/2000 22:03'!thoroughWhichSelectorsReferTo: literal special: specialFlag byte: specialByte	"Answer a set of selectors whose methods access the argument as a 	literal. Dives into the compact literal notation, making it slow but 	thorough "	| who |	who _ Set new.	self selectorsAndMethodsDo:		[:sel :method |		((method hasLiteralThorough: literal) or: [specialFlag and: [method scanFor: specialByte]])			ifTrue:				[((literal isMemberOf: Association) not					or: [method sendsToSuper not					or: [method literals allButLast includes: literal]])						ifTrue: [who add: sel]]].	^ who! !!Behavior methodsFor: 'testing method dictionary' stamp: 'sma 6/3/2000 22:01'!whichSelectorsReferTo: literal special: specialFlag byte: specialByte	"Answer a set of selectors whose methods access the argument as a literal."	| who |	who _ Set new.	self selectorsAndMethodsDo: 		[:sel :method |		((method hasLiteral: literal) or: [specialFlag and: [method scanFor: specialByte]])			ifTrue:				[((literal isMemberOf: Association) not					or: [method sendsToSuper not					or: [method literals allButLast includes: literal]])						ifTrue: [who add: sel]]].	^ who! !!CompiledMethod methodsFor: 'literals' stamp: 'sma 6/3/2000 21:39'!hasLiteralThorough: literal	"Answer true if any literal in this method is literal,	even if embedded in array structure."	| lit |	2 to: self numLiterals + 1 do: 		[:index | 		(lit _ self objectAt: index) == literal ifTrue: [^ true].		(lit class == Array and: [lit hasLiteral: literal]) ifTrue: [^ true]].	^ false! !!FileDirectory methodsFor: 'file status' stamp: 'sma 6/3/2000 22:11'!entryAt: fileName ifAbsent: aBlock	"Find the entry with local name fileName and answer it.	If not found, answer the result of evaluating aBlock."	| comparisonBlock |	self isCaseSensitive		ifTrue: [comparisonBlock _ [:entry | (entry at: 1) = fileName]]		ifFalse: [comparisonBlock _ [:entry | (entry at: 1) sameAs: fileName]].	^ self entries detect: comparisonBlock ifNone: [aBlock value]! !