'From Squeak 2.5 of August 6, 1999 [latest update: #1499] on 28 September 1999 at 11:24:12 pm'!"Change Set:		magnifier3-diDate:			28 September 1999Author:			Dan IngallsA simple hack offering 'be round' / 'be square' option for magnifiers.Note resizing is only possible when the magnifier is square."!!MagnifierMorph methodsFor: 'menu' stamp: 'di 9/28/1999 23:06'!addCustomMenuItems: aCustomMenu hand: aHandMorph	super addCustomMenuItems: aCustomMenu hand: aHandMorph.	aCustomMenu		addLine;		add: 'magnification...' action: #chooseMagnification;		addUpdating: #trackingPointerString action: #toggleTrackingPointer;		addUpdating: #toggleRoundString action: #toggleRoundness.! !!MagnifierMorph methodsFor: 'magnifying' stamp: 'di 9/28/1999 23:02'!magnifiedForm	| srcRect form exclusion |	lastPos _ self sourcePoint.	srcRect _ self sourceRectFrom: lastPos.	((srcRect intersects: self bounds) and: [ RecursionLock == nil ])		ifTrue: [RecursionLock _ self.				self isRound					ifTrue: [exclusion _ owner]					ifFalse: [exclusion _ self].				form _ self world patchAt: srcRect without: exclusion andNothingAbove: false.				RecursionLock _ nil]		ifFalse: ["cheaper method if the source is not occluded"				form _ Display copy: (srcRect translateBy: self world viewBox origin)].	"smooth if non-integer scale"	^ form magnify: form boundingBox		by: magnification		smoothing: (magnification isInteger ifTrue: [1] ifFalse: [2])! !!MagnifierMorph methodsFor: 'round view' stamp: 'di 9/28/1999 23:01'!isRound	^ owner isMemberOf: ScreeningMorph! !!MagnifierMorph methodsFor: 'round view' stamp: 'di 9/28/1999 23:17'!toggleRoundString	^ self isRound		ifTrue: ['be square']		ifFalse: ['be round']! !!MagnifierMorph methodsFor: 'round view' stamp: 'di 9/28/1999 23:16'!toggleRoundness	| sm w |	w _ self world.	self isRound		ifTrue: [owner delete.				w addMorph: self]		ifFalse: [sm _ ScreeningMorph new position: self position.				sm addMorph: self.				sm addMorph: (EllipseMorph newBounds: self bounds).				w addMorph: sm]! !