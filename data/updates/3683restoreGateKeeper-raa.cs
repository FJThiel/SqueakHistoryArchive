'From Squeak3.1alpha of 5 February 2001 [latest update: #3686] on 21 February 2001 at 11:58:07 am'!"Change Set:		restoreGateKeeperDate:			21 February 2001Author:			Bob Arningrestore EToyGateKeeperEntry which somehow fell out of the 3.0 gamma image"!MorphicModel subclass: #EToyGateKeeperEntry	instanceVariableNames: 'ipAddress accessAttempts lastTimes acceptableTypes latestUserName attempsDenied lastRequests '	classVariableNames: 'KnownIPAddresses '	poolDictionaries: ''	category: 'Morphic-Experimental'!EToyGateKeeperEntry class	instanceVariableNames: ''!!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/31/2000 12:42'!acceptableTypes	^acceptableTypes! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/31/2000 14:11'!dateAndTimeStringFrom: totalSeconds	| dateAndTime |	dateAndTime _ Time dateAndTimeFromSeconds: totalSeconds.	^dateAndTime first printString,' ',dateAndTime second printString! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/31/2000 13:51'!fullInfoString	^self latestUserName,		' at ',		ipAddress ,		' attempts: ',		accessAttempts printString,		'/',		attempsDenied printString,		' last: ',		(self lastIncomingMessageTimeString)	 "acceptableTypes" ! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/11/2000 12:19'!getChoice: aString	^acceptableTypes includes: aString! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 8/4/2000 11:49'!initialize	self flag: #bob.		"need to decide better initial types"	super initialize.	ipAddress _ '???'.	accessAttempts _ attempsDenied _ 0.	lastRequests _ OrderedCollection new.	acceptableTypes _ Set withAll: EToyIncomingMessage allTypes. ! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/11/2000 09:33'!ipAddress	^ipAddress! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/11/2000 09:18'!ipAddress: aString	ipAddress _ aString! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/31/2000 13:37'!lastIncomingMessageTimeString	lastRequests isEmpty ifTrue: [^'never'].	^self dateAndTimeStringFrom: lastRequests first first! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/31/2000 13:56'!lastTimeChecked	^self valueOfProperty: #lastTimeChecked! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/31/2000 13:57'!lastTimeChecked: aDateAndTimeInSeconds	self setProperty: #lastTimeChecked toValue: aDateAndTimeInSeconds! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/31/2000 14:22'!lastTimeCheckedString	| statusTime |	statusTime _ self valueOfProperty: #lastTimeChecked ifAbsent: [^'none'].	^(self dateAndTimeStringFrom: statusTime)! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/11/2000 10:49'!latestUserName	^latestUserName ifNil: ['???']! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/11/2000 10:46'!latestUserName: aString	latestUserName _ aString! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/31/2000 14:09'!requestAccessOfType: aString	| ok |	accessAttempts _ accessAttempts + 1.	lastRequests addFirst: {Time totalSeconds. aString}.	lastRequests size > 10 ifTrue: [		lastRequests _ lastRequests copyFrom: 1 to: 10.	].	ok _ (acceptableTypes includes: aString) or: [acceptableTypes includes: 'all'].	ok ifFalse: [attempsDenied _ attempsDenied + 1].	^ok! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/31/2000 14:10'!statusReplyReceived: anArray	self setProperty: #lastStatusReplyTime toValue: Time totalSeconds.	self setProperty: #lastStatusReply toValue: anArray.! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 8/1/2000 14:16'!statusReplyReceivedString	| statusTime |	statusTime _ self valueOfProperty: #lastStatusReplyTime ifAbsent: [^'none'].	^(self dateAndTimeStringFrom: statusTime),' accepts:', (self valueOfProperty: #lastStatusReply) asArray printString! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/11/2000 09:38'!timeBetweenLastAccessAnd: currentTime	lastRequests isEmpty ifTrue: [^0].	^currentTime - lastRequests first first! !!EToyGateKeeperEntry methodsFor: 'as yet unclassified' stamp: 'RAA 7/11/2000 10:39'!toggleChoice: aString	(acceptableTypes includes: aString) ifTrue: [		acceptableTypes remove: aString ifAbsent: []	] ifFalse: [		acceptableTypes add: aString	].! !!EToyGateKeeperEntry class methodsFor: 'as yet unclassified' stamp: 'RAA 8/3/2000 07:48'!includeInNewMorphMenu	"Not to be instantiated from the menu"	^ false! !!EToyGateKeeperMorph class methodsFor: 'as yet unclassified' stamp: 'RAA 2/21/2001 11:57'!entryForIPAddress: ipAddressString	| known entry |	UpdateCounter _ self updateCounter + 1.	known _ self knownIPAddresses.	entry _ known at: ipAddressString ifAbsentPut: [		entry _ EToyGateKeeperEntry new.		entry ipAddress: ipAddressString.		entry	].	^entry! !