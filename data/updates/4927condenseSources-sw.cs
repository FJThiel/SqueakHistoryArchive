'From Squeak3.3alpha of 18 January 2002 [latest update: #4925] on 25 July 2002 at 11:53:56 pm'!"Change Set:		condenseSources-swDate:			25 July 2002Author:			Scott WallaceBecause the presence of spurious concrete '-- all -- method categories breaks the condenseSources process, we now make a preemptive call to the method that fixes up all such errors before proceeding with the real work of condenseSources.  Thanks to Boris Gaertner for finding this problem."!!SystemDictionary methodsFor: 'housekeeping' stamp: 'sw 7/25/2002 23:46'!condenseSources		"Move all the changes onto a compacted sources file."	"Smalltalk condenseSources"	| f classCount dir newVersionString |	Utilities fixUpProblemsWithAllCategory.	"The above removes any concrete, spurious '-- all --' categories, which mess up the process."	dir _ FileDirectory default.	newVersionString _ FillInTheBlank request: 'Please designate the versionfor the new source code file...' initialAnswer: SourceFileVersionString.	newVersionString ifNil: [^ self].	newVersionString = SourceFileVersionString ifTrue:		[^ self error: 'The new source file must not be the same as the old.'].	SourceFileVersionString _ newVersionString.	"Write all sources with fileIndex 1"	f _ FileStream newFileNamed: self sourcesName.	f header; timeStamp.'Condensing Sources File...'	displayProgressAt: Sensor cursorPoint	from: 0 to: Smalltalk classNames size	during:		[:bar | classCount _ 0.		Smalltalk allClassesDo:			[:class | bar value: (classCount _ classCount + 1).			class fileOutOn: f moveSource: true toFile: 1]].	f trailer; close.	"Make a new empty changes file"	self closeSourceFiles.	dir rename: self changesName		toBe: self changesName , '.old'.	(FileStream newFileNamed: self changesName)		header; timeStamp; close.	LastQuitLogPosition _ 0.	self setMacFileInfoOn: self changesName.	self setMacFileInfoOn: self sourcesName.	self openSourceFiles.	self inform: 'Source files have been rewritten!!Check that all is well,and then save/quit.'! !