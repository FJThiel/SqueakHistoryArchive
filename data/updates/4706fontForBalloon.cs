'From Squeak3.1beta of 14 November 2001 [latest update: #4478] on 9 December 2001 at 9:56:22 pm'!"Change Set:		fontForBalloonDate:			5 December 2001Author:			stephane DucasseAllows to specify a font for the balloon based on the morph. Per default the default font is the one defined on BalloonMorph. Look at the tests TestBalloonFont "!TestCase subclass: #TestBalloonFont	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'TestBalloonFont'!!Morph methodsFor: 'halos and balloon help' stamp: 'sd 12/5/2001 20:29'!balloonFont	^ self		valueOfProperty: #balloonFont		ifAbsent: [self defaultBalloonFont]! !!Morph methodsFor: 'halos and balloon help' stamp: 'sd 12/5/2001 20:30'!balloonFont: aFont 	^ self setProperty: #balloonFont toValue: aFont! !!Morph methodsFor: 'halos and balloon help' stamp: 'sd 12/5/2001 20:23'!defaultBalloonFont	^ BalloonMorph balloonFont! !!BalloonMorph class methodsFor: 'instance creation' stamp: 'sd 12/5/2001 20:27'!string: str for: morph corner: cornerName 	"Make up and return a balloon for morph. Find the quadrant that 	clips the text the least, using cornerName as a tie-breaker. tk 9/12/97"	| tm vertices |	tm _ self getTextMorph: str for: morph.	vertices _ self getVertices: tm bounds.	vertices _ self				getBestLocation: vertices				for: morph				corner: cornerName.	^ self new color: morph balloonColor;		 setVertices: vertices;		 addMorph: tm;		 setTarget: morph! !!BalloonMorph class methodsFor: 'private' stamp: 'sd 12/5/2001 20:28'!getTextMorph: aStringOrMorph for: balloonOwner	"Construct text morph."	| m text |	aStringOrMorph isMorph		ifTrue: [m _ aStringOrMorph]		ifFalse: [BalloonFont				ifNil: [text _ aStringOrMorph]				ifNotNil: [text _ Text								string: aStringOrMorph								attribute: (TextFontReference toFont: balloonOwner balloonFont)].			m _ (TextMorph new contents: text) centered].	m setToAdhereToEdge: #adjustedCenter.	^ m! !!TestBalloonFont methodsFor: 'tests' stamp: 'sd 12/9/2001 21:44'!testDefaultFont	"(self selector: #testDefaultFont) debug"	self assert: RectangleMorph new balloonFont = BalloonMorph balloonFont.	self assert: RectangleMorph new defaultBalloonFont = BalloonMorph balloonFont.! !!TestBalloonFont methodsFor: 'tests' stamp: 'sd 12/9/2001 21:55'!testSpecificFont	"(self selector: #testSpecificFont) debug"	| aMorph |	aMorph := RectangleMorph new.	self assert: RectangleMorph new balloonFont = BalloonMorph balloonFont.	self assert: RectangleMorph new defaultBalloonFont = BalloonMorph balloonFont.	aMorph		balloonFont: (StrikeFont familyName: #ComicPlain size: 19).	self assert: aMorph balloonFont			= (StrikeFont familyName: #ComicPlain size: 19).	"The next test is horrible because I do no know how to access the font 	with the appropiate interface"	self assert: (((BalloonMorph getTextMorph: 'lulu' for: aMorph) text runs at: 1)			at: 1) font			= (StrikeFont familyName: #ComicPlain size: 19)! !BalloonMorph class removeSelector: #getTextMorph:!