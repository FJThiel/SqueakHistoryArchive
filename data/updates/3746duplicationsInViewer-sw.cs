'From Squeak3.1alpha of 5 February 2001 [latest update: #3752] on 1 March 2001 at 11:20:59 am'!"Change Set:		duplicationsInViewer-swDate:			1 March 2001Author:			Scott WallaceFixes problems that could cause:* Some categories to be listed twice in some viewers.* Some elements to be listed twice in some categories"!!Morph methodsFor: 'scripting' stamp: 'sw 3/1/2001 11:04'!categoriesForViewer	"Answer a list of symbols representing the categories to offer in the viewer, in order"	| aClass aList predetermined genericItems |	aClass _ self renderedMorph class.	aList _ OrderedCollection new.	[aClass == Morph] whileFalse:		[(aClass class includesSelector: #additionsToViewerCategories) ifTrue:			[aList addAllFirstUnlessAlreadyPresent: (aClass additionsToViewerCategories collect:				[:categorySpec | categorySpec first])].		aClass _ aClass superclass]. 	genericItems _ Morph additionsToViewerCategories collect:			[:categorySpec | categorySpec first].	aList removeAllFoundIn: genericItems.	aList addAllFirstUnlessAlreadyPresent: (Morph additionsToViewerCategories collect:			[:categorySpec | categorySpec first]) asSet asOrderedCollection.	predetermined _ #(basic #'color & border' geometry motion #'pen use' tests miscellaneous) select:		[:sym | aList includes: sym].  "bulletproof agains change in those names elsewhere"	aList removeAllFoundIn: predetermined.	^ predetermined, aList! !!OrderedCollection methodsFor: 'adding' stamp: 'sw 3/1/2001 11:03'!addAllFirstUnlessAlreadyPresent: anOrderedCollection 	"Add each element of anOrderedCollection at the beginning of the receiver, preserving the order, but do not add any items that are already in the receiver.  Answer anOrderedCollection."	anOrderedCollection reverseDo:		[:each | (self includes: each) ifFalse: [self addFirst: each]].	^ anOrderedCollection! !!ScriptActivationButton class methodsFor: 'viewer' stamp: 'sw 2/28/2001 21:59'!additionsToViewerCategories	"Answer a list of (<categoryName> <list of category specs>) pairs that characterize the phrases this kind of morph wishes to add to various Viewer categories."	^ #((button (			(slot color 'The color of the object' color readWrite player getColor  player  setColor:)			(slot height  'The height' number readWrite player getHeight  player  setHeight:) 			(slot borderColor 'The color of the object''s border' color readWrite player getBorderColor player  setBorderColor:)			(slot borderWidth 'The width of the object''s border' number readWrite player getBorderWidth player setBorderWidth:)			(slot roundedCorners 'Whether corners should be rounded' boolean readWrite player getRoundedCorners player setRoundedCorners:) 			(slot actWhen 'When the script should fire' buttonPhase  readWrite player getActWhen player setActWhen: ))))! !!ScriptableButton class methodsFor: 'viewer' stamp: 'sw 2/28/2001 22:00'!additionsToViewerCategories	"Answer a list of (<categoryName> <list of category specs>) pairs that characterize the phrases this kind of morph wishes to add to various Viewer categories."	^ #((button (			(slot label 'The wording on the button' string readWrite player getLabel player setLabel:)			(slot color 'The color of the object' color readWrite player getColor  player  setColor:)			(slot height  'The height' number readWrite player getHeight  player  setHeight:) 			(slot borderColor 'The color of the object''s border' color readWrite player getBorderColor player  setBorderColor:)			(slot borderWidth 'The width of the object''s border' number readWrite player getBorderWidth player setBorderWidth:)			(slot  height  'The height' number readWrite player getHeight  player  setHeight:)			(slot roundedCorners 'Whether corners should be rounded' boolean readWrite player getRoundedCorners player setRoundedCorners:) 			(slot actWhen 'When the script should fire' buttonPhase  readWrite player getActWhen player setActWhen: ))))! !