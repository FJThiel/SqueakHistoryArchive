'From R&DSqueak2.8 of 6 June 2001 [latest update: #42] on 17 December 2001 at 8:42:27 am'!"Change Set:		MIDIStoreWAV-jmDate:			16 December 2001Author:			Mark Guzdial and John MaloneyImplements ScorePlayer>duration so that you can store a MIDI score toa WAV file. Here's an example:  score _ MIDIFileReader scoreFromFileNamed: 'riff.mid'.  player _ ScorePlayer onScore: score.  player storeWAVOnFileNamed: 'riff.wav'.Mark did the first version, John made it work for MIDI filescontaining tempo changes."!!ScorePlayer methodsFor: 'accessing' stamp: 'jm 12/16/2001 11:59'!duration	"Answer the duration in seconds of my MIDI score when played at the current rate. Take tempo changes into account."	| totalSecs currentTempo lastTempoChangeTick |	totalSecs _ 0.0.	currentTempo _ 120.0.  "quarter notes per minute"	lastTempoChangeTick _ 0.	score tempoMap ifNotNil: [		score tempoMap do: [:tempoEvt |			"accumulate time up to this tempo change event"			secsPerTick _ 60.0 / (currentTempo * rate * score ticksPerQuarterNote).			totalSecs _ totalSecs + (secsPerTick * (tempoEvt time - lastTempoChangeTick)).			"set the new tempo"			currentTempo _ (120.0 * (500000.0 / tempoEvt tempo)) roundTo: 0.01.			lastTempoChangeTick _ tempoEvt time]].	"add remaining time through end of score"	secsPerTick _ 60.0 / (currentTempo * rate * score ticksPerQuarterNote).	totalSecs _ totalSecs + (secsPerTick * (score durationInTicks - lastTempoChangeTick)).	^ totalSecs! !