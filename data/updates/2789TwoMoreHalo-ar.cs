'From Squeak2.9alpha of 13 June 2000 [latest update: #2827] on 7 October 2000 at 11:40:22 pm'!"Change Set:		TwoMoreHalo-arDate:			7 October 2000Author:			Andreas RaabTwo more tweaks - shake off halos by a quick click on the desktop and make the halo handles stay inside the world."!!HaloMorph methodsFor: 'private' stamp: 'ar 10/7/2000 23:36'!basicBox	| aBox minSide anExtent w |	minSide _ 4 * self handleSize.	anExtent _ ((self width + self handleSize + 8) max: minSide) @				((self height + self handleSize + 8) max: minSide).	aBox _ Rectangle center: self center extent: anExtent.	w _ self world ifNil:[target outermostWorldMorph].	^ w		ifNil:			[aBox]		ifNotNil:			[aBox intersect: (w viewBox insetBy: 8@8)]! !!HaloMorph methodsFor: 'private' stamp: 'ar 10/7/2000 23:36'!basicBoxForSimpleHalos	| w |	w _ self world ifNil:[target outermostWorldMorph].	^ (target topRendererOrSelf worldBoundsForHalo expandBy: self handleAllowanceForIconicHalos)			intersect: (w bounds insetBy: 8@8)! !!PasteUpMorph methodsFor: 'event handling' stamp: 'ar 10/7/2000 23:38'!mouseDown: evt	"Handle a mouse down event."	| grabbedMorph |	grabbedMorph _ self morphToGrab: evt.	grabbedMorph ifNotNil:[		grabbedMorph isPartsDonor 			ifTrue:[^grabbedMorph partRepresented duplicateMorph: evt].		^evt hand grabMorph: grabbedMorph].	(super handlesMouseDown: evt)		ifTrue:[^super mouseDown: evt].	evt hand halo: nil. "shake off halos"	evt hand releaseKeyboardFocus. "shake of keyboard foci"	evt shiftPressed ifTrue:[^self dragThroughOnDesktop: evt].	self isWorldMorph ifTrue:[self addAlarm: #invokeWorldMenu: with: evt after: 200].! !