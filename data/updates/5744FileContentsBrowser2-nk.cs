'From Squeak3.7alpha of 11 September 2003 [latest update: #5707] on 18 February 2004 at 6:38:17 pm'!"Change Set:		FileContentsBrowserFixes2-nkDate:			18 February 2004Author:			Ned KonzChanges isMetaClass to isMeta in PseudoClass and PseudoMetaclass to avoid problems with browsing code files that include classes that aren't already defined."!!FilePackage methodsFor: 'accessing' stamp: 'nk 2/18/2004 18:31'!fixClassOrder	"Essentially bubble sort the classOrder so that superclasses appear before subclasses"	| superClass index subClass superIndex |	index := 0.	[index < classOrder size] whileTrue:[		subClass := classOrder at: (index := index + 1).		superClass := nil.		subClass isMeta ifTrue:[			"Treat non-meta as superclass"			superClass := self classes at: subClass name ifAbsent:[nil].		] ifFalse:[			subClass hasDefinition ifTrue:[				superClass := self classes 					at: (Scanner new scanTokens: subClass definition) first ifAbsent:[nil].				superClass ifNotNil:[superClass hasDefinition ifFalse:[superClass := nil]].			].		].		superClass ifNotNil:[			superIndex := classOrder indexOf: superClass ifAbsent:[self error:'Where is the class?'].			superIndex > index ifTrue:[				"Move superClass before index"				classOrder remove: superClass.				classOrder add: superClass before: subClass.				"Rewind index - we need to check superClass itself"				index := index - 1.			].		].	].! !!PseudoClass methodsFor: 'class' stamp: 'nk 2/18/2004 18:30'!renameTo: aString	self hasDefinition ifTrue:[		self isMeta ifTrue:[			self definition: (self definition				copyReplaceAll: name,' class'				with: aString, ' class').		] ifFalse:[			self definition: (self definition 					copyReplaceAll:'ubclass: #',name					with:'ubclass: #', aString)]].	name := aString.	metaClass ifNotNil:[metaClass renameTo: aString].! !!PseudoClass methodsFor: 'accessing' stamp: 'nk 2/18/2004 18:32'!allSuperclasses	^ (self realClass ifNil: [ ^#() ]) allSuperclasses! !!PseudoClass methodsFor: 'accessing' stamp: 'nk 2/18/2004 18:32'!realClass	^Smalltalk at: self name asSymbol ifAbsent: []! !!PseudoClass methodsFor: 'private' stamp: 'nk 2/18/2004 18:33'!allSubclassesWithLevelDo: classAndLevelBlock startingLevel: level	^ (self realClass ifNil: [ ^self ])  allSubclassesWithLevelDo: classAndLevelBlock startingLevel: level! !!PseudoClass methodsFor: 'testing' stamp: 'nk 2/18/2004 18:30'!isMeta	^false! !!PseudoMetaclass methodsFor: 'testing' stamp: 'nk 2/18/2004 18:30'!isMeta	^true! !PseudoMetaclass removeSelector: #isMetaClass!PseudoClass removeSelector: #isMetaClass!