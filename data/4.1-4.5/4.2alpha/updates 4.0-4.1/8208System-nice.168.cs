"Change Set:		8208System-nice.168System-nice.168:Incorrect use of StandardFileStream in #condenseChangesidentified in http://code.google.com/p/pharo/issues/detail?id=830condensing changes and doing modifications before saving the image will mess some non ASCII characters.a user will generally save as soon as condensed, but above mess can likely happen with scripts."!!SystemDictionary methodsFor: 'housekeeping' stamp: 'adrian-lienhard 5/27/2009 21:28'!condenseChanges	"Move all the changes onto a compacted sources file."	"Smalltalk condenseChanges"	| f oldChanges count |	f := FileStream fileNamed: 'ST80.temp'.	f header; timeStamp.	'Condensing Changes File...'		displayProgressAt: Sensor cursorPoint		from: 0		to: self classNames size + self traitNames size		during: [:bar | 			count := 0.			self				allClassesAndTraitsDo: [:classOrTrait | 					bar value: (count := count + 1).					classOrTrait moveChangesTo: f.					classOrTrait putClassCommentToCondensedChangesFile: f.					classOrTrait classSide moveChangesTo: f]].	SmalltalkImage current lastQuitLogPosition: f position.	f trailer; close.	oldChanges := SourceFiles at: 2.	oldChanges close.	FileDirectory default deleteFileNamed: oldChanges name , '.old';		 rename: oldChanges name toBe: oldChanges name , '.old';		 rename: f name toBe: oldChanges name.	self setMacFileInfoOn: oldChanges name.	SourceFiles		at: 2		put: (FileStream oldFileNamed: oldChanges name)! !!SystemDictionary methodsFor: 'sources, change log' stamp: 'adrian-lienhard 5/27/2009 21:28'!writeRecentCharacters: nCharacters toFileNamed: aFilename	"Schedule an editable text view on the last n characters of changes."	| changes |	changes := SourceFiles at: 2.	changes setToEnd; skip: nCharacters negated.	(FileStream newFileNamed: aFilename) nextPutAll: (changes next: nCharacters); close; open; edit! !