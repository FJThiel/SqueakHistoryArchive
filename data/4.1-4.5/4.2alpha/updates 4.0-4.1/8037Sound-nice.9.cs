"Change Set:		8037Sound-nice.9Sound-nice.9:Use #keys rather than #fasterKeysNote that pattern (x keys asArray sort) could as well be written (x keys sort) now that keys returns an Array...This #asArray is here solely for cross-dialect/fork compatibility."!!PianoRollScoreMorph methodsFor: 'event handling' stamp: 'stephaneducasse 2/4/2006 20:41'!mouseMove: evt	| noteMorphs chordRect sound |	soundsPlaying ifNil: [^ self].	self autoScrollForX: evt cursorPoint x.	"Play all notes at the cursor time"	noteMorphs := self notesInRect: ((evt cursorPoint extent: 1@0) expandBy: 0@self height).	chordRect := (self innerBounds withLeft: evt cursorPoint x) withWidth: 1.	soundsPlayingMorph delete.	soundsPlayingMorph := Morph newBounds: chordRect color: Color green.	self addMorphBack: soundsPlayingMorph.		noteMorphs do:		[:m |  "Add any new sounds"		(soundsPlaying includesKey: m)			ifFalse: [sound := m soundOfDuration: 999.0.					soundsPlaying at: m put: sound.					SoundPlayer resumePlaying: sound quickStart: false]].	soundsPlaying keys do:		[:m |  "Remove any sounds no longer in selection."		(noteMorphs includes: m)			ifFalse: [(soundsPlaying at: m) stopGracefully.					soundsPlaying removeKey: m]].! !!AbstractSound class methodsFor: 'sound library' stamp: 'jm 1/14/1999 13:00'!updateFMSounds	"AbstractSound updateFMSounds"	Sounds keys do: [:k |		((Sounds at: k) isKindOf: FMSound) ifTrue: [			Sounds removeKey: k ifAbsent: []]].	(FMSound class organization listAtCategoryNamed: #instruments) do:		[:sel | Sounds at: sel asString put: (FMSound perform: sel)].! !!AbstractSound class methodsFor: 'sound library-file in/out' stamp: 'nice 10/20/2009 23:34'!unloadSampledTimbres	"This can be done to unload those bulky sampled timbres to shrink the image. The unloaded sounds are replaced by a well-known 'unloaded sound' object to enable the unloaded sounds to be detected when the process is reversed."	"AbstractSound unloadSampledTimbres"	Sounds keys do: [:soundName |		(((Sounds at: soundName) isKindOf: SampledInstrument) or:		 [(Sounds at: soundName) isKindOf: LoopedSampledSound]) ifTrue: [			Sounds at: soundName put: self unloadedSound]].	self updateScorePlayers.	Smalltalk garbageCollect.! !!SampledSound class methodsFor: 'sound library' stamp: 'stephaneducasse 2/4/2006 20:41'!soundNames	"Answer a list of sound names for the sounds stored in the sound library."	"| s |	 SampledSound soundNames asSortedCollection do: [:n |		n asParagraph display.		s := SampledSound soundNamed: n.		s ifNotNil: [s playAndWaitUntilDone]]"	^ SoundLibrary keys asArray! !!AbstractSound class methodsFor: 'sound library' stamp: 'nice 10/21/2009 00:02'!soundNames	^ Sounds keys asArray sort! !