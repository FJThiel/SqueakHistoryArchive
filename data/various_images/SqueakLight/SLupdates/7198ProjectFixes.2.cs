'From SqueakLight|II of 31 May 2008 [latest update: #7195] on 23 July 2008 at 8:15:42 am'!AlignmentMorphBob1 subclass: #EToyGenericDialogMorph	instanceVariableNames: 'namedFields'	classVariableNames: ''	poolDictionaries: ''	category: 'EToys-Experimental'!EToyGenericDialogMorph subclass: #EToyProjectRenamerMorph	instanceVariableNames: 'actionBlock theProject'	classVariableNames: ''	poolDictionaries: ''	category: 'EToys-Experimental'!EToyProjectRenamerMorph subclass: #EToyProjectDetailsMorph	instanceVariableNames: 'projectDetails'	classVariableNames: ''	poolDictionaries: ''	category: 'EToys-Experimental'!TextMorph subclass: #ShowEmptyTextMorph	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'EToys-Experimental'!!ShowEmptyTextMorph commentStamp: '<historical>' prior: 0!A slight modification on TextMorph to show empty fields just as one would fields with data: with a cursor and without the pink field!!EToyGenericDialogMorph methodsFor: 'initialization' stamp: 'dgd 1/7/2005 19:18'!defaultBorderColor	"answer the default border color/fill style for the receiver"	^ ColorTheme current dialogBorderColor! !!EToyGenericDialogMorph methodsFor: 'initialization' stamp: 'dgd 1/7/2005 19:19'!defaultBorderWidth	"answer the default border width for the receiver"	^ ColorTheme current dialogBorderWidth! !!EToyGenericDialogMorph methodsFor: 'initialization' stamp: 'dgd 2/14/2003 19:54'!initialize	"initialize the state of the receiver"super initialize.""	namedFields _ Dictionary new.		self rebuild! !!EToyGenericDialogMorph methodsFor: 'initialization' stamp: 'jam 3/9/2003 18:05'!rebuild	"rebuilds the receiver"	^ self! !!EToyGenericDialogMorph methodsFor: 'as yet unclassified' stamp: 'dgd 7/12/2003 12:33'!genericTextFieldNamed: aString 	| newField |	newField := ShowEmptyTextMorph new beAllFont: self myFont;				 extent: 400 @ 20;				 contentsWrapped: ''.	namedFields at: aString put: newField.	^ newField! !!EToyGenericDialogMorph methodsFor: 'as yet unclassified' stamp: 'dgd 11/2/2004 21:18'!inAColumnForText: someMorphs 	^ (self inAColumn: someMorphs) hResizing: #shrinkWrap;		 color: ColorTheme current dialogTextBoxColor;		 borderColor: ColorTheme current dialogTextBoxBorderColor;		 borderWidth: ColorTheme current dialogButtonBorderWidth;		 useRoundedCorners! !!EToyGenericDialogMorph methodsFor: 'as yet unclassified' stamp: 'dgd 11/2/2004 21:13'!lockedString: aString 	^ self lockedString: aString font: self myFont! !!EToyGenericDialogMorph methodsFor: 'as yet unclassified' stamp: 'dgd 11/2/2004 21:13'!lockedString: aString font: aFont	^ self inAColumn: {(StringMorph contents: aString font: aFont) lock}! !!EToyGenericDialogMorph methodsFor: 'as yet unclassified' stamp: 'dgd 7/12/2003 12:29'!myFont	^ Preferences standardEToysFont! !!EToyGenericDialogMorph methodsFor: 'as yet unclassified' stamp: 'dgd 11/2/2004 21:53'!rightLockedString: aString 	^ self rightLockedString: aString font: self myFont! !!EToyGenericDialogMorph methodsFor: 'as yet unclassified' stamp: 'dgd 11/2/2004 21:54'!rightLockedString: aString font: aFont 	^ self inARightColumn: {(StringMorph contents: aString font: aFont) lock}! !!EToyProjectRenamerMorph methodsFor: 'as yet unclassified' stamp: 'RAA 9/21/2000 15:01'!buttonColor	^color darker! !!EToyProjectRenamerMorph methodsFor: 'as yet unclassified' stamp: 'dgd 11/2/2004 21:25'!buttonNamed: aString action: aSymbol color: aColor help: helpString	| f col |	f _ SimpleButtonMorph new		target: self;		label: aString translated font: self myFont;		color: aColor;		borderColor: aColor muchDarker;		actionSelector: aSymbol;		setBalloonText: helpString translated.	col _ (self inAColumn: {f}) hResizing: #spaceFill.	^col! !!EToyProjectRenamerMorph methodsFor: 'as yet unclassified' stamp: 'dgd 11/2/2004 21:24'!cancelButton	^ self		buttonNamed: 'Cancel'		action: #doCancel		color: ColorTheme current cancelColor		help: 'Cancel this Publish operation.'! !!EToyProjectRenamerMorph methodsFor: 'as yet unclassified' stamp: 'RAA 9/21/2000 15:06'!doCancel	self delete.! !!EToyProjectRenamerMorph methodsFor: 'as yet unclassified' stamp: 'ar 2/23/2001 20:55'!doOK	self validateTheProjectName ifFalse: [^self].	self delete.	actionBlock value: (namedFields at: 'projectname') contents string withBlanksTrimmed.! !!EToyProjectRenamerMorph methodsFor: 'as yet unclassified' stamp: 'yo 2/23/2005 17:25'!fieldForProjectName	| tm |	tm _ self genericTextFieldNamed: 'projectname'.	tm crAction: (MessageSend receiver: self selector: #doOK).	tm setBalloonText: 'Pick a name 24 characters or less and avoid the following characters: : < > | / \ ? * " .' translated.	^tm	! !!EToyProjectRenamerMorph methodsFor: 'as yet unclassified' stamp: 'dgd 11/2/2004 21:23'!okButton	^ self		buttonNamed: 'OK'		action: #doOK		color: ColorTheme current okColor		help: 'Change my name and continue publishing.'! !!EToyProjectRenamerMorph methodsFor: 'as yet unclassified' stamp: 'RAA 10/12/2000 13:55'!project: aProject actionBlock: aBlock	theProject _ aProject.	actionBlock _ aBlock.	(namedFields at: 'projectname') contentsWrapped: theProject name.! !!EToyProjectRenamerMorph methodsFor: 'as yet unclassified' stamp: 'RAA 10/12/2000 12:36'!rebuild	self removeAllMorphs.	self addARow: {		self lockedString: 'Please name this project'.	}.	self addARow: {		self inAColumnForText: {self fieldForProjectName}	}.	self addARow: {		self okButton.		self cancelButton.	}.! !!EToyProjectRenamerMorph methodsFor: 'as yet unclassified' stamp: 'dgd 10/8/2003 18:53'!validateTheProjectName	| proposed |	proposed _ (namedFields at: 'projectname') contents string withBlanksTrimmed.	proposed isEmpty ifTrue: [		self inform: 'I do need a name for the project' translated.		^false	].	proposed size > 24 ifTrue: [		self inform: 'Please make the name 24 characters or less' translated.		^false	].	(Project isBadNameForStoring: proposed) ifTrue: [		self inform: 'Please remove any funny characters from the name' translated.		^false	].	proposed = theProject name ifTrue: [^true].	(ChangeSorter changeSetNamed: proposed) ifNotNil: [		Utilities inform: 'Sorry that name is already used' translated.		^false	].	^true! !!EToyProjectRenamerMorph methodsFor: 'initialization' stamp: 'dgd 11/2/2004 21:09'!defaultColor	"answer the default color/fill style for the receiver"	^ ColorTheme current dialogColor! !!EToyProjectRenamerMorph methodsFor: 'initialization' stamp: 'dgd 1/7/2005 19:21'!initialize	"initialize the state of the receiver"	super initialize.	""	self vResizing: #shrinkWrap;		 hResizing: #shrinkWrap;		 layoutInset: 4;		 useRoundedCorners;		 rebuild! !!EToyProjectDetailsMorph methodsFor: 'initialization' stamp: 'dgd 11/3/2004 17:55'!rebuild	| bottomButtons |	self removeAllMorphs.	self addARow: {		self			lockedString: 'Please describe this project' translated			font: Preferences standardEToysTitleFont.	}.	self addARow: {self space }.	self addARow: {		self rightLockedString: 'Name:' translated.		self inAColumnForText: {self fieldForProjectName}	}.	self expandedFormat ifTrue: [		self fieldToDetailsMappings do: [ :each |			self addARow: {				self rightLockedString: each third translated.				self inAColumnForText: {(self genericTextFieldNamed: each first) height: each fourth}			}.		].	].	self addARow: {self space }.	bottomButtons _ self expandedFormat		ifTrue: [ { self okButton. self cancelButton } ]		ifFalse: [ { self okButton. self expandButton. self cancelButton } ].	self addARow: bottomButtons.	self fillInDetails.! !!EToyProjectDetailsMorph methodsFor: 'initialization' stamp: 'dgd 11/3/2004 17:29'!space	^ RectangleMorph new extent: 5 @ 5;		 color: Color transparent;		 borderWidth: 0 ! !!EToyProjectDetailsMorph methodsFor: 'as yet unclassified' stamp: 'ar 2/23/2001 20:56'!copyOutDetails	| newDetails |	newDetails _ Dictionary new.	self fieldToDetailsMappings do: [ :each |		namedFields at: each first ifPresent: [ :field |			newDetails at: each second put: field contents string		].	].	namedFields at: 'projectname' ifPresent: [ :field |		newDetails at: 'projectname' put: field contents string withBlanksTrimmed.	].	^newDetails! !!EToyProjectDetailsMorph methodsFor: 'as yet unclassified' stamp: 'RAA 10/20/2000 09:45'!doExpand	self expandedFormat: true.	self copyOutDetails.	self rebuild.! !!EToyProjectDetailsMorph methodsFor: 'as yet unclassified' stamp: 'RAA 10/12/2000 12:43'!doOK	self validateTheProjectName ifFalse: [^false].	actionBlock value: self copyOutDetails.	self delete.! !!EToyProjectDetailsMorph methodsFor: 'as yet unclassified' stamp: 'yo 2/23/2005 17:24'!expandButton	^self		buttonNamed: 'More' translated		action: #doExpand 		color: self buttonColor 		help: 'Show more info on this project.' translated.! !!EToyProjectDetailsMorph methodsFor: 'as yet unclassified' stamp: 'dgd 3/16/2004 12:10'!expandedFormat	^ Preferences expandedPublishing			or: [self valueOfProperty: #expandedFormat ifAbsent: [false]]! !!EToyProjectDetailsMorph methodsFor: 'as yet unclassified' stamp: 'RAA 10/20/2000 09:40'!expandedFormat: aBoolean	self setProperty: #expandedFormat toValue: aBoolean! !!EToyProjectDetailsMorph methodsFor: 'as yet unclassified' stamp: 'RAA 10/12/2000 13:33'!fieldToDetailsMappings	^#(		(#description 'projectdescription' 'Description:' 100) 		(#author 'projectauthor' 'Author:' 20) 		(#category 'projectcategory' 'Category:' 20)		(#subCategory 'projectsubcategory' 'Sub-category:' 20)		(#keywords 'projectkeywords' 'Key words:' 20)	)! !!EToyProjectDetailsMorph methodsFor: 'as yet unclassified' stamp: 'RAA 10/12/2000 13:55'!fillInDetails	theProject ifNotNil: [		namedFields at: 'projectname' ifPresent: [ :field |			field contentsWrapped: theProject name		].	].	projectDetails ifNotNil: [		self fieldToDetailsMappings do: [ :each |			namedFields at: each first ifPresent: [ :field |				projectDetails at: each second ifPresent: [ :data |					field contentsWrapped: data				].			].		].	].! !!EToyProjectDetailsMorph methodsFor: 'as yet unclassified' stamp: 'RAA 10/12/2000 12:45'!project: aProject actionBlock: aBlock	theProject _ aProject.	actionBlock _ aBlock.	projectDetails _ theProject world valueOfProperty: #ProjectDetails ifAbsent: [Dictionary new]! !!EToyProjectDetailsMorph methodsFor: 'as yet unclassified' stamp: 'RAA 10/12/2000 11:08'!projectDetails: aDictionary	projectDetails _ aDictionary.! !!EToyProjectRenamerMorph class methodsFor: 'as yet unclassified' stamp: 'RAA 10/18/2000 12:35'!validate: aProject andDo: aBlock	(self new)		project: aProject actionBlock: aBlock;		openCenteredInWorld! !!EToyProjectDetailsMorph class methodsFor: 'as yet unclassified' stamp: 'tak 3/15/2005 15:52'!getFullInfoFor: aProject ifValid: aBlock expandedFormat: expandedFormat	| me |	(me _ self basicNew)		expandedFormat: expandedFormat;		project: aProject		actionBlock: [ :x | 			aProject world setProperty: #ProjectDetails toValue: x.			x at: 'projectname' ifPresent: [ :newName | 				aProject renameTo: newName.			].			me delete.			aBlock value.		];		initialize;		becomeModal;		openCenteredInWorld! !!EToyProjectDetailsMorph class methodsFor: 'as yet unclassified' stamp: 'mir 6/19/2001 10:17'!test1: aProject"EToyProjectDetailsMorph test1: Project current"	(self basicNew)		project: aProject		actionBlock: [ :x | 			aProject world setProperty: #ProjectDetails toValue: x.			x at: 'projectname' ifPresent: [ :newName | 				aProject renameTo: newName.			]		];		initialize;		openCenteredInWorld! !!ShowEmptyTextMorph methodsFor: 'drawing' stamp: 'RAA 2/6/2001 14:09'!drawOn: aCanvas	self setDefaultContentsIfNil.	aCanvas paragraph: self paragraph bounds: bounds color: color.! !