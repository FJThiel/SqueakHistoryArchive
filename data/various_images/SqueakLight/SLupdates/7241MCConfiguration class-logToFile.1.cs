'From SqueakLight|II of 31 May 2008 [latest update: #7243] on 30 September 2009 at 10:27:29 am'!Object subclass: #MCConfiguration	instanceVariableNames: 'name dependencies repositories log '	classVariableNames: 'DefaultLog LogToFile '	poolDictionaries: ''	category: 'MonticelloConfigurations'!!MCConfiguration methodsFor: 'accessing' stamp: 'ar 9/19/2009 11:50'!log	"Answer the receiver's log. If no log exist use the default log"	log ifNil: [		(name notNil and:[self class logToFile]) ifFalse:[^Transcript].		self log: (FileStream fileNamed: self name, '.log').	].	^log! !!MCConfiguration class methodsFor: 'preferences' stamp: 'ar 8/21/2009 21:18'!logToFile	"Whether to log configuration info to files by default.	If true, logs to a file named after the configuration (config.nn.log).	If false, logs to the transcript."	<preference: 'Log config info to disk' 		category: 'Monticello' 		description: 'If true, configuration information (such as change logs) are logged to disk instead of the Transcript. The log file is named after the configuration map (config.nn.log)' 		type: #Boolean>	^LogToFile ifNil:[true].! !!MCPackageLoader methodsFor: 'private' stamp: 'edc 9/30/2009 10:11'!useChangeSetNamed: baseName during: aBlock 	"Use the named change set, or create one with the given name."	| changeHolder oldChanges newChanges csName |	changeHolder := (ChangeSet respondsTo: #newChanges:)				ifTrue: [ChangeSet]				ifFalse: [Smalltalk].	oldChanges := (ChangeSet respondsTo: #current)				ifTrue: [ChangeSet current]				ifFalse: [Smalltalk changes].	self class changeHighestUpdate		ifTrue: [csName := (SystemVersion current highestUpdate + 1) asString , baseName.			newChanges := (ChangesOrganizer changeSetNamed: csName)						ifNil: [ChangeSet new name: csName].			changeHolder newChanges: newChanges.			[aBlock value]				ensure: [changeHolder newChanges: oldChanges].			SystemVersion current registerUpdate: SystemVersion current highestUpdate + 1]		ifFalse: [newChanges := (ChangesOrganizer changeSetNamed: baseName)						ifNil: [ChangeSet new name: baseName].			changeHolder newChanges: newChanges.			[aBlock value]				ensure: [changeHolder newChanges: oldChanges]].			newChanges fileOut! !Object subclass: #MCConfiguration	instanceVariableNames: 'name dependencies repositories log'	classVariableNames: 'DefaultLog LogToFile'	poolDictionaries: ''	category: 'MonticelloConfigurations'!