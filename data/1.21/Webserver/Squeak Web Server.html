<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252"><title>Squeak Web Server</title></head>
<body><table width="100%"><tbody><tr><td><hr><h1>Squeak Web Server</h1><hr></td><td align="right">
<img kasperskylab_antibanner="on" src="Squeak%20Web%20Server-Dateien/IULogo.htm"></td></tr></tbody></table>

<h2>Introduction</h2>
This is a web server for <a href="http://ftp.squeak.org/1.21/Webserver/Squeak/">Squeak</a>,
 implemented entirely inside Squeak. Its purpose is to make Squeak a 
web-based OODBMS/object server/application server (pick your name). Some
 of its features are
<ul>
<li>user authentication
</li><li>forms support
</li><li>transaction logging for image roll forward in case of a crash
</li><li>per user undo facility
</li><li>nightly housekeeping operations
</li></ul>
<p><b>Note:</b> Currently this is not a full fledged HTTP 1.0 server, namely
</p><ul><li>no support for simple requests (nobody sends them anyway)
</li><li>any request that is not POST is treated as GET</li></ul>

<h2>Principles of Operation</h2>
<h3>URLs</h3>
The server handles URLs of the form <code>'objectId.message'</code>. Additional parameters delimited by dots may be appended.<br>
Since OOP's are not fixed in Squeak the web server maintains its own objectId's. There are two kinds of them
<ul><li><b>automatic</b><br>These are numeric and generated on demand. 
They are  purged nightly to avoid garbage accumulation (Squeak has no 
weak references). These URL's should not be bookmarked. 
</li><li><b>manual</b><br>These are alphabetic and managed by the system
 administrator. They represent the 'official' entrypoints and thus may 
be bookmarked.
</li></ul>
Message is always a single parameter keyword message (with the trailing 
colon omitted) with the parameter describing the request.
The corresponding method must be in the Category "HTML Reply" to be 
accepted otherwise a "400 Bad Request" message is returned. The same 
reply is triggered by any execution error.
<h3>Authentication</h3>
The <code>WWW-Authenticate: Basic</code> mechanism is used.
It is up to the individual HTML-generating method to use the 
authentification information to decide whether the request is legitimate
 or how to customize the response. Utility methods provide for the RFC 
1421 encoding of username/password combinations and mapping them to 
application defined 'user' objects.
<h3>Forms</h3>
Forms information is extracted to a dictionary with the field names as 
keys and the field data as values. Multivalued fields (multiple 
selection lists, checkbox groups) return an array of values.
<h3>Transaction Log</h3>
The log contains information to rerun all requests in case of a crash. 
Since this includes username/password information the log has to be kept
 as secure as the image itself. To guarantee (approximately) accurate 
timestamps when rolling forward Time has been augmented with a 'Bias' 
class variable. All senders of <code>Time&gt;primSecondsClock</code> must be modified to apply the bias (<code>Time dateAndTimeNow</code> and <code>Time&gt;totalSeconds</code> in the standard image).
<h3>Undo</h3>
Undo is implemented by creating undo objects holding receiver, message, 
and parameters. It is the responsibility of the request (form) 
processing methods to build these objects. Only the (n) newest undo 
objects are kept, furthermore they are purged during the night. Every 
user sees only her/his undos.
<h2>Implementation Notes</h2>
<dl>
<dt>String constants
</dt><dd>Some string constants are stored in the pool dictionary TextConstants.
</dd><dt><code>TextConstants at: #HttpAuthorize</code>
</dt><dd>You may want to use a different realm.
</dd><dt><code>WebRequest&gt;getReply</code>
</dt><dd>Use the name of your local proxy server or eliminate the first line if you don't care. 
</dd><dt><code>WebRequest&gt;noProxy</code>
</dt><dd>Write about your own proxy policy (if you have one, see <code>WebRequest&gt;getReply</code>).
</dd><dt><code>WebRequest&gt;robots</code>
</dt><dd>Insert your robot policy.
</dd><dt><code>WebRequest&gt;title</code>
</dt><dd>Adjust the header to your local needs.
</dd><dt><code>WebRequest&gt;getReply</code>
</dt><dd>Adjust the page footer to your local needs.
</dd></dl>
<h2>Source code</h2>
Get <a href="http://ftp.squeak.org/1.21/Webserver/WebServer.st">WebServer.st</a> and <a href="http://ftp.squeak.org/1.21/Webserver/miscChanges.st">miscChanges.st</a> and file them into a 1.21 image. Execute <code>WebRequest serveOnPort: 8080 loggingTo: 'test.log'</code>. Then load the URL <code>http://your.server:8080/Server.demo</code> in your favorite web browser.
<p><b>Notes on version 0.1.1:</b></p><ul><li>The code has been tested by loading into a virgin 1.21 image on the Mac. Let me know whether it works on other platforms.
</li><li>The example implements a very simple class hierarchy browser, demonstrating forms and authentication.
</li><li>Username/passwort for stopping the server is "manager"/"squeak".
</li><li>Running both Squeak and the browser on the same machine gave halting performance on my Mac.
</li><li>You might experience some freezes or crashes. Whether due to bugs in the socket primitives or misuse on my side, I do not know.
</li><li>Sometimes the server seemes to be deaf. Aborting and retrying the request at the browser side usually corrects this.
</li><li>Image roll forward and undo are not yet implemented.
</li></ul>
<hr>Feel free to <a href="mailto:gollmann@edvz.tuwien.ac.at">contact me</a> if you have any comments or questions.
<hr><address>
<a href="http://ftp.squeak.org/1.21/Webserver/English.html">Georg Gollmann</a>, <a href="http://iuinfo.tuwien.ac.at/welcome.html">Dept.
Systems Support (IU)</a>,
19.8.1997</address>

</body></html>